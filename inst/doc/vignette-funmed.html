<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="John J. Dziak" />

<meta name="date" content="2023-11-08" />

<title>Demonstrating functional mediation</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Demonstrating functional mediation</h1>
<h4 class="author">John J. Dziak</h4>
<h4 class="date">2023-11-08</h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The <code>funmediation</code> package fits a functional mediation
model to a dataset consisting of intensive longitudinal data for a
sample of individuals. For each individual <span class="math inline">\(i\)</span>, the model assumes a time-invariant
(i.e., non-time-varying) randomized treatment or exposure <span class="math inline">\(X_i\)</span>, a distal outcome <span class="math inline">\(Y_i\)</span> observed at one time point (e.g.,
end-of-study), and a time-varying mediator <span class="math inline">\(M_i(t)\)</span> observed repeatedly during the
interval after <span class="math inline">\(X_i\)</span> is observed and
before <span class="math inline">\(Y_i\)</span> is observed. <span class="math inline">\(X_i\)</span> is treated as a number; that means it
can either be dichotomous (and coded as 0 for no and 1 for yes) or
continuous (and entered as the number). If <span class="math inline">\(X_i\)</span> is categorical with more than two
categories, it needs to be entered as multiple binary dummy codes. The
research question is whether the effect of <span class="math inline">\(X_i\)</span> on <span class="math inline">\(Y_i\)</span> is mediated by the process <span class="math inline">\(M_i(t)\)</span>. A similar model was first
proposed by Lindquist (2012). <span class="math inline">\(M_i(t)\)</span> can be continuous or binary, and
<span class="math inline">\(Y_i\)</span> can also be either continuous
or binary. The treatment variable <span class="math inline">\(X_i\)</span> is assumed to be binary.</p>
</div>
<div id="notation" class="section level1">
<h1>Notation</h1>
<p>The mediation model for <code>funmediation</code> is fit in
stages.</p>
<p>First, the effect of <span class="math inline">\(X_i\)</span> on
<span class="math inline">\(M_i\)</span> is fit behind the scenes as a
time-varying effects (longitudinal varying coefficients) model (TVEM;
see Hastie and Tibshirani, 1993; Tan et al., 2012). The assumed mean
model is <span class="math inline">\(E(M_i(t)) = \alpha_0(t) +
\alpha_X(t) X_i\)</span> for continuous <span class="math inline">\(M_i(t)\)</span>, or <span class="math inline">\(\mathrm{logit}^{-1}(E(M_i(t))) = \alpha_0(t) +
\alpha_X(t) X_i\)</span> for binary <span class="math inline">\(M_i(t)\)</span>. This fits the marginal
(population-averaged) mean: that is, without random effects but with a
sandwich covariance estimate to handle within-subject correlation, as in
working-independence generalized estimating equations.<br />
This part of the model is fit using the <code>tvem</code> function in
the <code>tvem</code> R package.</p>
<p>Next, the effect of <span class="math inline">\(X_i\)</span> and
<span class="math inline">\(M_i(t)\)</span> on <span class="math inline">\(Y_i\)</span> is modeled as a scalar-on-function
functional regression (see Goldsmith et al., 2011). The assumed mean
model is either <span class="math inline">\(E(Y_i) = \beta_0 +
\beta_{X}X_i+ \int\beta_M(t)M_i(t)dt\)</span> for continuous <span class="math inline">\(Y_i\)</span>, or <span class="math inline">\(\mathrm{logit}^{-1}(E(Y_i)) = \beta_0 +
\beta_{X}X_i+ \int\beta_M(t)M_i(t)dt\)</span> for binary <span class="math inline">\(Y_i\)</span>.<br />
This part of the model is fit using the <code>pfr</code> function in the
<code>refund</code> R package (see Goldsmith et al., 2011).<br />
Both the <code>tvem</code> and <code>refund</code> packages use the
<code>mgcv</code> package (see Wood, 2017) for back-end
calculations.</p>
<p>In this mediation model, <span class="math inline">\(\alpha_X(t)\)</span> and <span class="math inline">\(\beta_M(t)\)</span> both must be nonzero in order
for an indirect effect (i.e., mediation) to exist. These two functions
arise conceptually from two different kinds of functional regression;
one represents a model with a concurrent function as a response (of
which TVEM is a special case), while the other represents a model with a
distal scalar response (see Ramsay and Silverman, 2005). However,
intuitively the size of the indirect effect has to do with both of them
combined. Here we operationally define the indirect effect as the
integral <span class="math inline">\(\int\alpha_X(t)\beta_M(t)dt\)</span>. Because
these functions are actually only estimated on a grid of points, the
integral is approximated as a weighted average of the cross-products of
the estimates. We obtain a bootstrap confidence interval for this
quantity using the <code>boot</code> package.</p>
</div>
<div id="including-covariates" class="section level1">
<h1>Including Covariates</h1>
<p>Covariates can be included in predicting <span class="math inline">\(M_i(t)\)</span> and <span class="math inline">\(Y_i\)</span>. For example, suppose there is a
covariate <span class="math inline">\(Z_i\)</span> which has a
time-varying relationship to <span class="math inline">\(M_i(t)\)</span>. The TVEM model for the mediator
can be expanded to <span class="math inline">\(E(M_i(t)) = \alpha_0(t) +
\alpha_X(t) X_i + \alpha_Z(t) Z_i\)</span> for continuous <span class="math inline">\(M_i(t)\)</span>, or <span class="math inline">\(\mathrm{logit}^{-1}(E(M_i(t))) = \alpha_0(t) +
\alpha_X(t) X_i+ \alpha_Z(t) Z_i\)</span> for binary <span class="math inline">\(M_i(t)\)</span>. It is possible for <span class="math inline">\(Z_i\)</span> to have a time-varying effect even if
the values of <span class="math inline">\(Z_i\)</span> do not vary over
time. That would mean that the correlation between the observation-level
<span class="math inline">\(M_i(t)\)</span> and the subject-level <span class="math inline">\(Z_i\)</span> is different for different values of
<span class="math inline">\(t\)</span>. It is currently not
<em>possible</em> to use a time-varying covariate in this package.</p>
<p>But it is possible to assume that the relationship between <span class="math inline">\(Z_i\)</span> and <span class="math inline">\(M_i(t)\)</span> does not depend on <span class="math inline">\(t\)</span>, whether or not <span class="math inline">\(Z_i\)</span> depends on <span class="math inline">\(t\)</span>; in this case <span class="math inline">\(\alpha_Z(t)\)</span> can simply be written as
<span class="math inline">\(\alpha_Z\)</span>. The package allows both
time-varying-effects and time-invariant-effects of covariates to be
specified in predicting the mediator, using the
<code>tve_covariates_on_mediator</code> and
<code>tie_covariates_on_mediator</code> arguments, respectively.</p>
<p>Alternatively, suppose that there is a subject-level covariate, <span class="math inline">\(S_i\)</span>, which predicts <span class="math inline">\(Y_i\)</span>. This can be added to the functional
regression model by specifying <span class="math inline">\(E(Y_i) =
\beta_0 + \beta_{X}X_i+ \beta_S S_i + \int\beta_M(t)M_i(t)dt\)</span>
for continuous <span class="math inline">\(Y_i\)</span>, or <span class="math inline">\(\mathrm{logit}^{-1}(E(Y_i)) = \beta_0 +
\beta_{X}X_i+ \beta_S S_i + \int\beta_M(t)M_i(t)dt\)</span> for binary
<span class="math inline">\(Y_i\)</span>. Such a covariate can be
included using the <code>covariates_on_outcome</code>. Currently, the
package assumes a subject-level <span class="math inline">\(Y_i\)</span>
and does not support multiple functional coefficients in predicting the
outcome; that is, the covariates in <code>covariates_on_outcome</code>
cannot have time-varying values or effects.</p>
</div>
<div id="example-with-continuous-outcomes" class="section level1">
<h1>Example with Continuous Outcomes</h1>
<p>The following example shows how to simulate example data and then
analyze it using the <code>funmediation</code> package.</p>
<div id="getting-ready-to-run-the-example" class="section level2">
<h2>Getting ready to run the example</h2>
<p>Before running the examples, first install and load the
<code>funmediation</code> package.<br />
A <code>.zip</code> or <code>.tar.gz</code> file containing the package
is available at <a href="https://github.com/dziakj1/funmediation_development">https://github.com/dziakj1/funmediation_development</a>,
and it can then be used with the <code>install.packages()</code>
function in R code, <code>Packages &gt; Install Package(s)</code> from
Local Files in the R graphical user interface, or
<code>Tools &gt; Install Packages</code> in the RStudio application, to
install the package.</p>
<p>We have also released <code>funmediation</code> on the CRAN archive,
so that it can be installed using the command</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;funmediation&quot;</span>)</span></code></pre></div>
<p>Another option is to install the package by code from the GitHub
repository as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">install_github</span>(<span class="st">&quot;dziakj1/funmediation&quot;</span>)</span></code></pre></div>
<p>Of course, if you are viewing this guide from within R using the
<code>vignette()</code> function, then the package is already
installed.</p>
<p>The next step is to load the required packages.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">library</span>(tvem)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; Loading required package: mgcv</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; Loading required package: nlme</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; This is mgcv 1.9-0. For overview type &#39;help(&quot;mgcv-package&quot;)&#39;.</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="fu">library</span>(refund)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;boot&#39;</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:refund&#39;:</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt;     cd4</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="fu">library</span>(funmediation)</span></code></pre></div>
<p>We then set a seed for replicability and simulate data.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>simulation1 <span class="ot">&lt;-</span> <span class="fu">simulate_funmediation_example</span>(<span class="at">nsub=</span><span class="dv">500</span>)</span></code></pre></div>
<p>The <code>simulation1</code> object will contain not only the
simulated dataset itself, but the true values of the simulated
parameters, including the indirect effect.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">str</span>(simulation1)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt; List of 8</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt;  $ time_grid     : num [1:100] 0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 0.09 0.1 ...</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt;  $ true_alpha_int: num [1:100] 0.1 0.141 0.173 0.2 0.224 ...</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt;  $ true_alpha_X  : num [1:100] -0.0707 -0.1 -0.1225 -0.1414 -0.1581 ...</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt;  $ true_beta_int : num 0</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt;  $ true_beta_M   : num [1:100] 0.00503 0.0101 0.01523 0.02041 0.02564 ...</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co">#&gt;  $ true_beta_X   : num 0.2</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt;  $ true_indirect : num -0.211</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt;  $ dataset       :&#39;data.frame&#39;:  20169 obs. of  5 variables:</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt;   ..$ subject_id: int [1:20169] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt;   ..$ t         : num [1:20169] 0.04 0.07 0.11 0.15 0.18 0.19 0.25 0.28 0.29 0.31 ...</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt;   ..$ X         : int [1:20169] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt;   ..$ M         : num [1:20169] 1.165 -0.653 -1.462 2.287 2.271 ...</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt;   ..$ Y         : num [1:20169] -0.181 -0.181 -0.181 -0.181 -0.181 ...</span></span></code></pre></div>
<p>We need the simulated dataset as a data.frame object.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>the_data <span class="ot">&lt;-</span> simulation1<span class="sc">$</span>dataset</span></code></pre></div>
<p>We can use the <code>head</code> and <code>summary</code> function in
R, in order to look at the first few lines of the data and univariate
descriptive statistics.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(the_data))</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt;   subject_id    t X          M        Y</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; 1          1 0.04 0  1.1647240 -0.18087</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; 2          1 0.07 0 -0.6525125 -0.18087</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; 3          1 0.11 0 -1.4620807 -0.18087</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; 4          1 0.15 0  2.2871677 -0.18087</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; 5          1 0.18 0  2.2713836 -0.18087</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt; 6          1 0.19 0  1.4810598 -0.18087</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="fu">summary</span>(the_data)</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt;    subject_id        t                X               M          </span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">#&gt;  Min.   :  1   Min.   :0.0100   Min.   :0.000   Min.   :-7.1295  </span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:125   1st Qu.:0.2500   1st Qu.:0.000   1st Qu.:-0.9189  </span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">#&gt;  Median :251   Median :0.5000   Median :0.000   Median : 0.4338  </span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt;  Mean   :251   Mean   :0.5041   Mean   :0.472   Mean   : 0.4349  </span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.:376   3rd Qu.:0.7600   3rd Qu.:1.000   3rd Qu.: 1.7870  </span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co">#&gt;  Max.   :500   Max.   :1.0000   Max.   :1.000   Max.   : 7.7515  </span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#&gt;        Y          </span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">#&gt;  Min.   :-2.9565  </span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co">#&gt;  1st Qu.:-0.4219  </span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co">#&gt;  Median : 0.2832  </span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co">#&gt;  Mean   : 0.3322  </span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co">#&gt;  3rd Qu.: 1.0521  </span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co">#&gt;  Max.   : 3.7903</span></span></code></pre></div>
<p>It would be reasonable to do other descriptive analyses but in order
to demonstrate the function we proceed immediately to the main
analysis.</p>
</div>
</div>
<div id="running-a-functional-mediation-model" class="section level1">
<h1>Running a Functional Mediation Model</h1>
<p>Now we call the functional mediation function. Only 10 bootstrap
samples are used below for this quick illustration. At least a few
hundred bootstraps are recommended in practice in order to increase
precision and power.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">funmediation</span>(<span class="at">data=</span>the_data,</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>                             <span class="at">treatment=</span>X,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                             <span class="at">mediator=</span>M,</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>                             <span class="at">outcome=</span>Y,</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>                             <span class="at">id=</span>subject_id,</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>                             <span class="at">time=</span>t,</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>                             <span class="at">nboot=</span><span class="dv">10</span>)  </span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; Warning in funmediation(data = the_data, treatment = X, mediator = M, outcome =</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; Y, : The number of bootstrap samples was very small and results will be</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; dubious.</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, (1 + c(conf, -conf))/2): extreme order statistics used</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; as endpoints</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, alpha): extreme order statistics used as endpoints</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, (1 + c(conf, -conf))/2): extreme order statistics used</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt; as endpoints</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, alpha): extreme order statistics used as endpoints</span></span></code></pre></div>
<p>The warning message, ``extreme order statistics used as endpoints,’’
occurs because too few bootstrap samples are used for the bootstrap
confidence intervals to be valid; however, we ignore this here in order
for the vignette example to run quickly.</p>
<p>The <code>print</code> function gives an initial overview of the
results.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">print</span>(model1)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt; Functional Regression Mediation Function Output </span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; TREATMENT: X </span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; MEDIATOR: M (Assumed Continuous) </span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; OUTCOME: Y (Assumed Continuous) </span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; DIRECT EFFECT OF X ...</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt;  Direct effect estimate:</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; -0.07192656</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt;  Direct effect standard error:</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; 0.1047166</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt;  Direct effect bootstrap estimate:</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; -0.1102083</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt;  Direct effect bootstrap confidence interval: </span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt;   ... by normal method:</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt;  -0.2939 ,  0.0735</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">#&gt; INDIRECT EFFECT OF X ...</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">#&gt;  Indirect effect parametric estimate:</span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co">#&gt;  -0.2522696</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co">#&gt;  Indirect effect bootstrap estimate:</span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="co">#&gt;  -0.2460247</span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="co">#&gt;  Indirect effect bootstrap confidence interval: </span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="co">#&gt;   ... by normal method:</span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="co">#&gt;  -0.3517 ,  -0.1404</span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a><span class="co">#&gt; Computation time:</span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="co">#&gt; Time difference of 18.58889 secs</span></span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a><span class="co">#&gt; Time-varying Effects Model Predicting MEDIATOR from TREATMENT:</span></span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a><span class="co">#&gt; Response variable:   MEDIATOR </span></span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a><span class="co">#&gt; Response outcome distribution type: gaussian </span></span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a><span class="co">#&gt; Time interval:   0.01 to 1 </span></span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a><span class="co">#&gt; Number of subjects:  500</span></span>
<span id="cb9-37"><a href="#cb9-37" tabindex="-1"></a><span class="co">#&gt; Effects specified as time-varying:  (Intercept), TREATMENT</span></span>
<span id="cb9-38"><a href="#cb9-38" tabindex="-1"></a><span class="co">#&gt; You can use the plot function to view the plots.</span></span>
<span id="cb9-39"><a href="#cb9-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-40"><a href="#cb9-40" tabindex="-1"></a><span class="co">#&gt; Back-end model fitted in mgcv::bam function: </span></span>
<span id="cb9-41"><a href="#cb9-41" tabindex="-1"></a><span class="co">#&gt; Method fREML</span></span>
<span id="cb9-42"><a href="#cb9-42" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb9-43"><a href="#cb9-43" tabindex="-1"></a><span class="co">#&gt; MEDIATOR ~ TREATMENT + s(time, bs = &quot;ps&quot;, by = NA, pc = 0, k = 7, </span></span>
<span id="cb9-44"><a href="#cb9-44" tabindex="-1"></a><span class="co">#&gt;     fx = FALSE) + s(time, bs = &quot;ps&quot;, by = TREATMENT, pc = 0, </span></span>
<span id="cb9-45"><a href="#cb9-45" tabindex="-1"></a><span class="co">#&gt;     m = c(2, 1), k = 7, fx = FALSE)</span></span>
<span id="cb9-46"><a href="#cb9-46" tabindex="-1"></a><span class="co">#&gt; Pseudolikelihood AIC: 84897.63</span></span>
<span id="cb9-47"><a href="#cb9-47" tabindex="-1"></a><span class="co">#&gt; Pseudolikelihood BIC: 84937.51 </span></span>
<span id="cb9-48"><a href="#cb9-48" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-49"><a href="#cb9-49" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb9-50"><a href="#cb9-50" tabindex="-1"></a><span class="co">#&gt; Functional Regression Model Predicting OUTCOME from MEDIATOR </span></span>
<span id="cb9-51"><a href="#cb9-51" tabindex="-1"></a><span class="co">#&gt;   and TREATMENT: </span></span>
<span id="cb9-52"><a href="#cb9-52" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-53"><a href="#cb9-53" tabindex="-1"></a><span class="co">#&gt; Family: gaussian </span></span>
<span id="cb9-54"><a href="#cb9-54" tabindex="-1"></a><span class="co">#&gt; Link function: identity </span></span>
<span id="cb9-55"><a href="#cb9-55" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-56"><a href="#cb9-56" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb9-57"><a href="#cb9-57" tabindex="-1"></a><span class="co">#&gt; OUTCOME ~ s(x = MEDIATOR.tmat, by = L.MEDIATOR) + TREATMENT</span></span>
<span id="cb9-58"><a href="#cb9-58" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-59"><a href="#cb9-59" tabindex="-1"></a><span class="co">#&gt; Estimated degrees of freedom:</span></span>
<span id="cb9-60"><a href="#cb9-60" tabindex="-1"></a><span class="co">#&gt; 2  total = 4 </span></span>
<span id="cb9-61"><a href="#cb9-61" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-62"><a href="#cb9-62" tabindex="-1"></a><span class="co">#&gt; REML score: 742.2459     </span></span>
<span id="cb9-63"><a href="#cb9-63" tabindex="-1"></a><span class="co">#&gt; Scalar terms in functional regression model:</span></span>
<span id="cb9-64"><a href="#cb9-64" tabindex="-1"></a><span class="co">#&gt; (Intercept)   TREATMENT </span></span>
<span id="cb9-65"><a href="#cb9-65" tabindex="-1"></a><span class="co">#&gt;  0.16499534 -0.07192656 </span></span>
<span id="cb9-66"><a href="#cb9-66" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb9-67"><a href="#cb9-67" tabindex="-1"></a><span class="co">#&gt; Parametric model for Predicting OUTCOME from TREATMENT </span></span>
<span id="cb9-68"><a href="#cb9-68" tabindex="-1"></a><span class="co">#&gt;   ignoring MEDIATOR: </span></span>
<span id="cb9-69"><a href="#cb9-69" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-70"><a href="#cb9-70" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb9-71"><a href="#cb9-71" tabindex="-1"></a><span class="co">#&gt; glm(formula = glm_formula)</span></span>
<span id="cb9-72"><a href="#cb9-72" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-73"><a href="#cb9-73" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb9-74"><a href="#cb9-74" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb9-75"><a href="#cb9-75" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.47332    0.06671   7.096 4.45e-12 ***</span></span>
<span id="cb9-76"><a href="#cb9-76" tabindex="-1"></a><span class="co">#&gt; TREATMENT   -0.30617    0.09730  -3.147  0.00175 ** </span></span>
<span id="cb9-77"><a href="#cb9-77" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb9-78"><a href="#cb9-78" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb9-79"><a href="#cb9-79" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-80"><a href="#cb9-80" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for gaussian family taken to be 1.179171)</span></span>
<span id="cb9-81"><a href="#cb9-81" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-82"><a href="#cb9-82" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 598.90  on 499  degrees of freedom</span></span>
<span id="cb9-83"><a href="#cb9-83" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 587.23  on 498  degrees of freedom</span></span>
<span id="cb9-84"><a href="#cb9-84" tabindex="-1"></a><span class="co">#&gt; AIC: 1505.3</span></span>
<span id="cb9-85"><a href="#cb9-85" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-86"><a href="#cb9-86" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 2</span></span>
<span id="cb9-87"><a href="#cb9-87" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-88"><a href="#cb9-88" tabindex="-1"></a><span class="co">#&gt; =======================================================</span></span></code></pre></div>
<p>The first part of the output above summarizes the estimated indirect
effect and its bootstrap confidence interval. The estimate for the
indirect effect <span class="math inline">\(\int
\alpha_X(t)\beta_M(t)\)</span> is given as about -0248. Choosing the
wider confidence interval in order to be conservative, a 95% confidence
interval extends from about -0.35 to -0.14. (This interval would not
actually be reliable in practice because of the low number of bootstrap
samples, which could be remedied by choosing a higher
<code>nboot</code>). Thus, there appears to be a significant negative
indirect effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> mediated through <span class="math inline">\(M(t)\)</span>.</p>
<p>The second part of the printed output summarizes the TVEM used to
predict <span class="math inline">\(M(t)\)</span> from <span class="math inline">\(X\)</span>. It only provides summary information
on the model that was fit. The time-varying coefficients are not
actually printed, because they are functions rather than single numbers.
They can be plotted using the <code>plot</code> function, as described
later. They are also stored in the <code>model1</code> output object, as
described later.</p>
<p>The third part summarizes the scalar-on-function functional
regression model used to predict <span class="math inline">\(Y\)</span>
from <span class="math inline">\(X\)</span> and <span class="math inline">\(M(t)\)</span>. This model involves scalar
(non-time-varying) coefficients for the intercept and the direct effect
of <span class="math inline">\(X\)</span>, and a functional
(time-varying) coefficient for the effect of <span class="math inline">\(M(t)\)</span>. The scalar coefficients are
printed, but as before, the functional coefficient needs to be plotted
using the <code>plot</code> function.</p>
<p>The fourth section of the printed output simply presents an estimate
of the total effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> ignoring <span class="math inline">\(M(t)\)</span>, obtained using the <code>glm</code>
function. <span class="math inline">\(X\)</span> is shown to have a
total negative effect on <span class="math inline">\(Y\)</span>, with an
estimated coefficient of <code>-0.30617</code> and <span class="math inline">\(p\)</span>-value of <code>0.00175</code>. This
suggests that the <span class="math inline">\(X=1\)</span> group has
statistically significantly lower average <span class="math inline">\(Y\)</span> than the <span class="math inline">\(X=0\)</span> group, irrespective of <span class="math inline">\(M\)</span>.</p>
<p>The <code>plot</code> function plots the results. Three kinds of
plots are available, represented by the options <code>tvem</code>,
<code>pfr</code>, and <code>coef</code>. The <code>tvem</code> plot
shows the estimates for <span class="math inline">\(\alpha_0(t)\)</span>
and <span class="math inline">\(\alpha_1(t)\)</span>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">plot</span>(model1, <span class="at">what_plot=</span><span class="st">&quot;tvem&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The intercept plot appears to be significantly above zero and
significantly increasing. It can be interpreted as the mean <span class="math inline">\(M(t)\)</span> for the control (<span class="math inline">\(X=0\)</span>) group because <span class="math inline">\(E(M(t)|X=0)=\alpha_0(t) + \alpha_X(t) \times
0=\alpha_0(t)\)</span>. The treatment effect plot is generally nonzero
and decreasing. It can be interpreted as <span class="math inline">\(E(M(t)|X=1)-E(M(t)|X=0)\)</span>, a time-specific
treatment effect on the mediator, and it suggests that as time goes on
the <span class="math inline">\(X=1\)</span> group tends to become lower
in average <span class="math inline">\(M(t)\)</span> than the <span class="math inline">\(X=0\)</span> group.</p>
<p>The <code>pfr</code> plot shows the estimate for <span class="math inline">\(\beta_M(t)\)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">plot</span>(model1, <span class="at">what_plot=</span><span class="st">&quot;pfr&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA21BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmOmZmOpBmZmZmZpBmkJBmkLZmkNtmtrZmtttmtv+QOgCQOjqQZgCQZjqQZmaQkDqQkLaQtpCQttuQ29uQ2/+2ZgC2Zjq2ZpC2kDq2kGa2kJC2ttu227a229u22/+2/9u2///bkDrbkGbbtmbbtpDbtrbb27bb29vb2//b////tmb/25D/27b/29v//7b//9v///9xZv3IAAAACXBIWXMAAA7DAAAOwwHHb6hkAAANKUlEQVR4nO2dDVsbuRHH1zmo3UIKR9qkzTUppE3b4zC96xWKD5oEQ7G+/yfq6m010mo1kq3dVdj5P0+M15ZG2p9Hr+PIFSMFVY1dgdJFgBARIEQECBEBQkSAEBEgRAQIEQFCRIAQESBEBAgRAUJEgBARIEQECBEBQkSAEBEgRAQIEQFClApoVSm9uIlKv/nnDdt8qPbvY9LCdJvbg7qUl9eh9JeLqjoWj0dOEeEieaWgiVClegb0+PrFdoCeXqtyTrrTr8X74vHbFECiUtBEqFI9A1rGehoXuKv6qdZZoC6zC/2YIlApPHM6IGNRFvT0in8E9es/XFbVnnyTN49vTnkKjvI/6sbv3tSvvrtnTuo77iwvLyxA9eewd15/1jUnJ2vdKqpqdnyvjM8OxOMPKqsuWJlq0sISl+bzlSYunKp9/7p60TTtfICkxLtL3TosQCoJeCpSr5unBlD9TN7B5i/HX5iVtS6Oa+/GB6gpWJoyaWGJHkCtqpn2uXUTO2sB2rvmjyfilr+9f3zF3xVJZG0fFvxRpgCp6zd/Jd48AYBqm3NQKMy65J+uSA6bmMxqCpbXVlpTv1YTc6q2f80+N2VnBHQmSprr11dHVwwCUtUSf2DqWp9+qv1gDgDJm2oEssrSagPCigPIFCyu7bRu/QCgdtWM8gHiJYlPHo4gBpB+dSVduknNNh+lwW5AMGv9TtNWXEB2J79/304rS3QBeaq2CyC3D4LurgHNrST64xSvrjlbO3W1949PNlm7icGs6yoISOcS1+20fkCeqvUNKMGDZHYnI+ikj65dDzqz6xL0ICftwB600qPQia8C65fngT6oSb3WnQPspJ1h3u6D5nb5rT6IF2w5LQbIU7VcgOq74vfgAKrv+Zh/nNphfaMY9KD9e27Ecj17omiPYrNTVo9U4oX2KKYK1sCctLJ+4B58o1g+QE0n6ADS0xHJyj8PsvqgVicNlhrH6qNw5kFmDg1bydI21UrbfIDah9TttKqWBxB7qO/i6N/uKMbUhPY9k1PZvSs4k35vrJhRbO981UxelNRi9Upemazs8SNfnF4zH6CmYHXtplUlXopJEbwdt2rbA5qcCBAiAoSIACEiQIgIECIChIgAISJAiOIALZtdyKVcQviSOFNhIRNg8anZXOLZQBCnKw4TtgYT3h7yafh5O7ARbUIrHpCYgYvVTTwgEGDxyQIEgjgdcRjEmlGzkNtz00ebaBQPSFRbrE87AcW9aGQBwoM4sTEksBXgBseSwlBC0YAOzYqcAzIBFdE29s6BBzVxnCZ+0BFVWYHqwhjFBTTvxJB0ho4YkjRbzU55PRZgj17sDDcmtE1oiK9k7w74DskvC2WNVyMW0G8XYtH84u8CEAioNJ+XBmTiOLo+XVGVTkDAvBtDumkg2CarxvXqWqincp/HA6ixCQ2pQqvqQBckXokFdPqhtvew2P+xUptyOqBS85jfc9QKEIjjmE1Zf1TFNLEzO05qm7diSAzceiuGJAQ2Epcmm4wtqD1HYxMY4jhO2G1dm1MQYooGdLYU2+AnKw4IBlSa8kEnreI46r3OqEoXoLZ5E0MCd+6PIcGQyEr6sQuobVPt5ko/2lefr8gSD2hd21hWZwIQCKjoUILpg0wcB25J+/bEuwDZ5u0IgFBnDCkKkLu5rxJKC/JR2JDViAQk4gl/fjW74C2KgYCKrtgSNDEdx5H16Y6qwD4IAgLmWzEkoa4YkvWmqrcVfNGAdAJoqAVIViMakOiMRbBJeJBuKPozaACBOA7uQX5AHvM2oKAH+TtpG1CsB51FNzE1JgnnmVuBPbcPAnEcbx8UAaht3sSQLFZuDElbEsP85nYB4gnryq0QtGkiSgCQeJoAaC0GRh3ebgIqchRbVsCDdBwHi6qYPsiOtDvmrRgSA77RiiE1bgHseqJTwKY9itmARDViAckRUbr/3Aq+6EkF7IN0J72u2vOgGEAe83a4piOGpGSWGtfMjk4pE8amPQ9yAKXMg2TTlZi4XRNQYZsfF/Ws1B7FZBynCbB0RFU6AUHzTgxJf7PJH0PSPsTfrQ5P1VchTHRKm2hsAkNtQKIaUYAmLAKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACHKDKj6ajQWoLzm+hMBQkSAEBGgLqnehwB1qHL+RmfIXH6hMoMXAfKp8j6NzpO5CsXJmvsQIFfO1JAAOXIrRoAstVcWBAjKUysCZORdmBKgRv4qESClrn0NAiTUve1DgMTmXeDNaCs5qtKbuV0UrsrkAWF7qhMHhG85TxtQRC2mDCgqYjFhQHFVmCyg2IDXVAHhnfOEN+1j4qXVhAHhRcOQ8+QAoRNDJyQ/NUBYua0vLEwLEOI+vm9zTApQBJ7p7kkjQ1fnd4GmAihYXuirUtMAtJ3zyHejy0iq0dDmti4M/ZrdBAAFvCPiW4jDAHp6xf/3PTwQYShAocYT9R3NAQGt5DnhZ7ubi9audFhPgD797bDWd1fNCxyQQrOSB84MAqi7kPgv+PYASByhLqSOj5OAHhYC0Fo2sv4BdRLo6evPsQk3l7M/XX3hz/736aeDY/37IEN7UJhOPJ/8gC5P4dWtPExUnmIzZ7q77htQJ4A0OCJH5oS/OMdjPrxXT2pG4uylk8Ry0xVuW8nW8ibcfHFf+a//B/L6A9SxYkhtWmFzuySsneV30o3WgeNQ+wHUvaLajg7rF9DKB2jV4yiWs2khNndIqE8qq4K/KpkfUGbn6XPTXntQJnMxykrn+e1JB+mklOTJkBvQv5xB6+md/KvPBMy/WM3kPEPtKD59Zx/F/gf961OqP9IToUyAstAZdsPs8c1xMxd6/Kh+gnnzoemvMy41Mqy2xtgP4sdHfnP49s1hvWY9Uu6kNzlYtsVq943Fb2REJeujkxanY1bV7Kj5md+8HhS4s8h+OaEB9jSKbT5/tq5X+ljjXfug4J3F0Eke2LIn9EsflK/PZ95u2h/8vm5EfzL+YtXIHdd3NIfcHN60SlqLSbm/hbyDuSjXQPCllGflzZ4QaNnpQAnlRsEJ90uxZXnzZ09oq2vLI3YcjhuQAoNaRDlh+9kTGvFuaEsPihxrwnPg3emwfvug7l8nCplLmwUHposxNiJKyZ5QaatRLHUB1TcdVsx2R+QM2E7e+d4uFWuZy54w2VzqOBOAueuQ5TOZPWHdun6+Z/y3PI79AQ1gLnXezxDnSTMVV172hGy9qGbfvzz/fPc6+570gE2rMZs94ebDKXv8I3eeh9/kDfuE8WxhMKrQ7Amffn8j/jH1uKO5JsPwziNtZ08oYhpis2OdrYkhU54kW4nqoQ9azd5KHb59++7njo56x1gDfC/B0hbqYxS7e3PYKMtiNcOW+tYqYB4UStX3UjSiCtkTZjSHrEXz1SZUh+wJM5lDt3myVidQj+wJ85gbv23psrInzGAO20HNW5WwigNUYQv7Ab1HFJc9YaS5quufpFPSv3EAeV9EFvdD9j1NmdkTbm0O3TMbnk5KoT0DwncUR/AeUWz2hFuYi9lwHQdPEYBitqNHch82PqCozfrx8IwNKM55RsRTAKCBy03W2E0MSzY2n8IBjY6nbEDjuw8rGVAReAoGVAaeYgEV4j6sTEAjz3xslQeoJDqsQEBl4SkOUGHuw4YCFHu4SXF4BgWEHm5SnvuwIQGhR1OUiGdIQMjhJkW6DyvGg0rFMxwgvjHWfbhJsXgGHOYDh5uU6z6siHlQyXgKAFS0+7ARAFmHmxS1LPVrdA8qXQQIEQFCNBSg/g436VkDAWofbvLVaBBA7aMpnp92XGq4h5s8P5EHIdq1D3ION3l+2nHYcQ83eX7KOC6vK/Bf6q2L9Oy1lmnQreyrKnjCSIpyAJJd0Zpve+g6WhdRcnOs07zSyr4SOzB5CGUDJCkt5+YVfRFvA+So224KIKf0eWLpAWUDJPem1aLeuoiSm2O1/9cUQFb2QgH9mvu3mg5ZF1FyctSXSX2Qnb3IJiY7ANUNWBdRsnNwi0mAnALTh4hOZRvFsgLi084dAC1rT3pY5JmZZQOUs4mJi+2bWHoPGFA+QBk76ZVaccf3Ilb2dP8NKBugzMN8ogdZ2SWtTMvnfDPpzBPFxJm0lb3IPkg0DF5DOQtZJY8jVnaWvNSwsvPj0zOtnr+aPdKxRIAQESBEBAgRAUL0FQBaZ9r62k7lAwKhkzFEgBAVD+hhMW5IoHhA5EGYCBAiAoSIACEiQIgIECL9Jf6RVD4gtqR5UMkiQIgIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIECIChIgAISJAiAgQIgKEiAAhIkCICBAiAoSIACEiQIgIEKL/A4dxI6JykqqHAAAAAElFTkSuQmCC" /><!-- --></p>
<p>The function tends to be nonzero at least for higher values of time,
and generally seems to be steadily increasing. One possible
interpretation is that the mediator becomes more important at later
times. Alternatively, perhaps individuals who increase more (or decrease
less) on average over time on the mediator tend to have a higher value
on the outcome (see Dziak et al., 2019).</p>
<p>The <code>pfrgam</code> plot does the same thing as the
<code>pfr</code> plot, but with a slightly different implementation
based on the <code>plot.gam</code> method from the <code>mgcv</code>
library.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">plot</span>(model1, <span class="at">what_plot=</span><span class="st">&quot;pfrgam&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Last, the <code>coef</code> plot summarizes all of the most important
coefficients estimated in the model. The upper left and upper right
panes show the estimates of <span class="math inline">\(\alpha_0(t)\)</span> and <span class="math inline">\(\alpha_X(t)\)</span> from the model of the effect
of <span class="math inline">\(X\)</span> on <span class="math inline">\(M(t)\)</span>. The lower left shows the estimate
of <span class="math inline">\(\beta_M(t)\)</span> from the model of the
effect of <span class="math inline">\(M(t)\)</span> on <span class="math inline">\(Y\)</span> given <span class="math inline">\(X\)</span>. In the lower right panel, the estimate
of the indirect effect is printed (not plotted, because it is a single
number).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">plot</span>(model1, <span class="at">what_plot=</span><span class="st">&quot;coef&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Because we have already looked at the relevant plots before using the
<code>coef</code> option, there is nothing new to interpret in the
<code>coef</code> plot; it is just intended as a convenient summary.</p>
<div id="exploring-information-in-the-output-objects" class="section level2">
<h2>Exploring Information in the Output Objects</h2>
<p>The output object created, called <code>model1</code>, contains
useful information both on the model fit to the original data and on the
bootstrapping results.</p>
<ul>
<li><p><code>model1$original_results$time_grid</code> is the grid of
time points on which the coefficient functions were estimated.</p></li>
<li><p><code>model1$original_results$alpha_int_estimate</code>,
<code>model1$original_results$alpha_int_se</code>,
<code>model1$original_results$alpha_X_estimate</code>, and
<code>model1$original_results$alpha_X_se</code> are the functional
coefficients and pointwise standard errors for the intercept and
treatment in the TVEM, at each point of the time grid.</p></li>
<li><p><code>model1$original_results$beta_int_estimate</code>,
<code>model1$original_results$beta_int_se</code>,
<code>model1$original_results$beta_X_estimate</code> and
<code>model1$original_results$beta_X_se</code> are the estimates and
standard errors for the scalar coefficients representing the intercept
and the direct treatment effect in the scalar-outcome functional linear
model.</p></li>
<li><p><code>model1$original_results$beta_M_estimate</code> and
<code>model1$original_results$beta_M_se</code> are the estimates and
pointwise standard errors representing the effect of the time-varying
mediator at each point of the time grid.</p></li>
<li><p><code>beta_M_pvalue</code> is the <span class="math inline">\(p\)</span>-value for an overall test of whether
the mediator is significantly associated with the outcome, i.e., whether
<span class="math inline">\(\beta_M(t)\)</span> can be shown not to be
all zeroes; see the documentation for the <code>pfr</code> function in
the <code>refund</code> package for more information.</p></li>
<li><p><code>model1$original_results$tau_int_estimate</code>, together
with <code>$tau_int_se</code>, <code>$tau_X_estimate</code>, and
<code>$tau_X_se</code>, represent the estimates of the intercept and
coefficient in the model for the total effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span>. Thus,
<code>model1$original_results$tau_X_estimate</code> is the estimated
total effect and <code>model1$original_results$tau_X_pvalue</code> is
the <span class="math inline">\(p\)</span>-value for testing whether
this effect is zero.</p></li>
<li><p><code>model1$original_results$indirect_effect_estimate</code>
gives the estimated value of <span class="math inline">\(\int
\alpha_X(t)\beta_M(t)\)</span> obtained without bootstrapping.</p></li>
<li><p><code>model1$original_results$tvem_XM_details</code>,
<code>$funreg_MY_details</code>, and <code>$total_effect_details</code>
give the fitted model objects from <code>tvem</code>, <code>pfr</code>
and <code>glm</code>. They might be useful for plots or diagnostics but
might contain more technical detail than some users are interested
in.</p></li>
</ul>
</div>
<div id="including-a-covariate" class="section level2">
<h2>Including a Covariate</h2>
<p>It is possible to run the model with one or more additional
covariates. To demonstrate this, the
<code>simulate_mediation_example</code> has an option
<code>make_covariate_S</code> to create an extra subject-level
covariate. The data is generated in such a way that <span class="math inline">\(S\)</span> is not actually related to <span class="math inline">\(X\)</span>, <span class="math inline">\(M\)</span>
or <span class="math inline">\(Y\)</span>, but the analyst is assumed
not to know this – that is, the simulated true value of its coefficient
is zero.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>simulation_with_covariate <span class="ot">&lt;-</span> <span class="fu">simulate_funmediation_example</span>(<span class="at">nsub=</span><span class="dv">500</span>,</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>                                             <span class="at">make_covariate_S=</span><span class="cn">TRUE</span>);</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>data_with_covariate <span class="ot">&lt;-</span> simulation_with_covariate<span class="sc">$</span>dataset; </span></code></pre></div>
<p>To include the covariate <span class="math inline">\(S_i\)</span>
with an assumption of a possibly time-varying effect <span class="math inline">\(\alpha_S(t)\)</span> on <span class="math inline">\(M(t)\)</span> (recall that the covariate can have
a time-varying effect even though it may not have time-varying values),
use the <code>covariates_on_outcome</code> and
<code>tve_covariates_on_mediator</code> arguments:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>model_with_tve_covariate <span class="ot">&lt;-</span> <span class="fu">funmediation</span>(<span class="at">data=</span>data_with_covariate,</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>                       <span class="at">treatment=</span>X,</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>                       <span class="at">mediator=</span>M,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>                       <span class="at">outcome=</span>Y,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>                       <span class="at">tve_covariates_on_mediator =</span> <span class="sc">~</span>S,</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>                       <span class="at">covariates_on_outcome =</span> <span class="sc">~</span>S,  </span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>                       <span class="at">id=</span>subject_id,</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>                       <span class="at">time=</span>t,</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>                       <span class="at">nboot=</span><span class="dv">10</span>)</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; Warning in funmediation(data = data_with_covariate, treatment = X, mediator =</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; M, : The number of bootstrap samples was very small and results will be</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt; dubious.</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, (1 + c(conf, -conf))/2): extreme order statistics used</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; as endpoints</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, alpha): extreme order statistics used as endpoints</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, (1 + c(conf, -conf))/2): extreme order statistics used</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; as endpoints</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, alpha): extreme order statistics used as endpoints</span></span></code></pre></div>
<p>Notice that the tilde (~) character needs to be included for the
covariates. This is done so that R will allow multiple covariates to be
listed in the style of the right side of a formula, e.g.,
<code>~S1 + S2</code>.</p>
<p>The covariates in <code>tve_covariates_on_mediator</code> and
<code>covariates_on_outcome</code> need to be subject-level and should
not have time-varying values; the function does not currently support
models with time-varying values other than the mediator. However, the
relationship of the covariates to the mediator can be specified as
either time-varying or time-invariant. The relationship of the covariate
to the outcome, in contrast, can only be specified as time- invariant in
the current version of the package. That is, <span class="math inline">\(M(t)\)</span> is the only time-varying predictor
in the functional regression predicting the outcome.</p>
<p>The results of the model fit can be viewed using the
<code>print</code> and <code>plot</code> functions:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">print</span>(model_with_tve_covariate)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#&gt; Functional Regression Mediation Function Output </span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co">#&gt; TREATMENT: X </span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">#&gt; MEDIATOR: M (Assumed Continuous) </span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co">#&gt; OUTCOME: Y (Assumed Continuous) </span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co">#&gt; DIRECT EFFECT OF X ...</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co">#&gt;  Direct effect estimate:</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="co">#&gt; 0.1125763</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="co">#&gt;  Direct effect standard error:</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co">#&gt; 0.1009101</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="co">#&gt;  Direct effect bootstrap estimate:</span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a><span class="co">#&gt; 0.06677104</span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a><span class="co">#&gt;  Direct effect bootstrap confidence interval: </span></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a><span class="co">#&gt;   ... by normal method:</span></span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a><span class="co">#&gt;  -0.124 ,  0.2575</span></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a><span class="co">#&gt; INDIRECT EFFECT OF X ...</span></span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a><span class="co">#&gt;  Indirect effect parametric estimate:</span></span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a><span class="co">#&gt;  -0.3018684</span></span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a><span class="co">#&gt;  Indirect effect bootstrap estimate:</span></span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a><span class="co">#&gt;  -0.2930111</span></span>
<span id="cb16-25"><a href="#cb16-25" tabindex="-1"></a><span class="co">#&gt;  Indirect effect bootstrap confidence interval: </span></span>
<span id="cb16-26"><a href="#cb16-26" tabindex="-1"></a><span class="co">#&gt;   ... by normal method:</span></span>
<span id="cb16-27"><a href="#cb16-27" tabindex="-1"></a><span class="co">#&gt;  -0.3663 ,  -0.2197</span></span>
<span id="cb16-28"><a href="#cb16-28" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb16-29"><a href="#cb16-29" tabindex="-1"></a><span class="co">#&gt; Computation time:</span></span>
<span id="cb16-30"><a href="#cb16-30" tabindex="-1"></a><span class="co">#&gt; Time difference of 27.21542 secs</span></span>
<span id="cb16-31"><a href="#cb16-31" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb16-32"><a href="#cb16-32" tabindex="-1"></a><span class="co">#&gt; Time-varying Effects Model Predicting MEDIATOR from TREATMENT:</span></span>
<span id="cb16-33"><a href="#cb16-33" tabindex="-1"></a><span class="co">#&gt; Response variable:   MEDIATOR </span></span>
<span id="cb16-34"><a href="#cb16-34" tabindex="-1"></a><span class="co">#&gt; Response outcome distribution type: gaussian </span></span>
<span id="cb16-35"><a href="#cb16-35" tabindex="-1"></a><span class="co">#&gt; Time interval:   0.01 to 1 </span></span>
<span id="cb16-36"><a href="#cb16-36" tabindex="-1"></a><span class="co">#&gt; Number of subjects:  500</span></span>
<span id="cb16-37"><a href="#cb16-37" tabindex="-1"></a><span class="co">#&gt; Effects specified as time-varying:  (Intercept), TREATMENT, S</span></span>
<span id="cb16-38"><a href="#cb16-38" tabindex="-1"></a><span class="co">#&gt; You can use the plot function to view the plots.</span></span>
<span id="cb16-39"><a href="#cb16-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-40"><a href="#cb16-40" tabindex="-1"></a><span class="co">#&gt; Back-end model fitted in mgcv::bam function: </span></span>
<span id="cb16-41"><a href="#cb16-41" tabindex="-1"></a><span class="co">#&gt; Method fREML</span></span>
<span id="cb16-42"><a href="#cb16-42" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb16-43"><a href="#cb16-43" tabindex="-1"></a><span class="co">#&gt; MEDIATOR ~ TREATMENT + S + s(time, bs = &quot;ps&quot;, by = NA, pc = 0, </span></span>
<span id="cb16-44"><a href="#cb16-44" tabindex="-1"></a><span class="co">#&gt;     k = 7, fx = FALSE) + s(time, bs = &quot;ps&quot;, by = TREATMENT, pc = 0, </span></span>
<span id="cb16-45"><a href="#cb16-45" tabindex="-1"></a><span class="co">#&gt;     m = c(2, 1), k = 7, fx = FALSE) + s(time, bs = &quot;ps&quot;, by = S, </span></span>
<span id="cb16-46"><a href="#cb16-46" tabindex="-1"></a><span class="co">#&gt;     pc = 0, m = c(2, 1), k = 7, fx = FALSE)</span></span>
<span id="cb16-47"><a href="#cb16-47" tabindex="-1"></a><span class="co">#&gt; Pseudolikelihood AIC: 83986.37</span></span>
<span id="cb16-48"><a href="#cb16-48" tabindex="-1"></a><span class="co">#&gt; Pseudolikelihood BIC: 84047.99 </span></span>
<span id="cb16-49"><a href="#cb16-49" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-50"><a href="#cb16-50" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb16-51"><a href="#cb16-51" tabindex="-1"></a><span class="co">#&gt; Functional Regression Model Predicting OUTCOME from MEDIATOR </span></span>
<span id="cb16-52"><a href="#cb16-52" tabindex="-1"></a><span class="co">#&gt;   and TREATMENT: </span></span>
<span id="cb16-53"><a href="#cb16-53" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-54"><a href="#cb16-54" tabindex="-1"></a><span class="co">#&gt; Family: gaussian </span></span>
<span id="cb16-55"><a href="#cb16-55" tabindex="-1"></a><span class="co">#&gt; Link function: identity </span></span>
<span id="cb16-56"><a href="#cb16-56" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-57"><a href="#cb16-57" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb16-58"><a href="#cb16-58" tabindex="-1"></a><span class="co">#&gt; OUTCOME ~ s(x = MEDIATOR.tmat, by = L.MEDIATOR) + TREATMENT + </span></span>
<span id="cb16-59"><a href="#cb16-59" tabindex="-1"></a><span class="co">#&gt;     S</span></span>
<span id="cb16-60"><a href="#cb16-60" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-61"><a href="#cb16-61" tabindex="-1"></a><span class="co">#&gt; Estimated degrees of freedom:</span></span>
<span id="cb16-62"><a href="#cb16-62" tabindex="-1"></a><span class="co">#&gt; 2  total = 5 </span></span>
<span id="cb16-63"><a href="#cb16-63" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-64"><a href="#cb16-64" tabindex="-1"></a><span class="co">#&gt; REML score: 729.0772     </span></span>
<span id="cb16-65"><a href="#cb16-65" tabindex="-1"></a><span class="co">#&gt; Scalar terms in functional regression model:</span></span>
<span id="cb16-66"><a href="#cb16-66" tabindex="-1"></a><span class="co">#&gt;  (Intercept)    TREATMENT            S </span></span>
<span id="cb16-67"><a href="#cb16-67" tabindex="-1"></a><span class="co">#&gt; -0.025787118  0.112576286 -0.001643264 </span></span>
<span id="cb16-68"><a href="#cb16-68" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb16-69"><a href="#cb16-69" tabindex="-1"></a><span class="co">#&gt; Parametric model for Predicting OUTCOME from TREATMENT </span></span>
<span id="cb16-70"><a href="#cb16-70" tabindex="-1"></a><span class="co">#&gt;   ignoring MEDIATOR: </span></span>
<span id="cb16-71"><a href="#cb16-71" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-72"><a href="#cb16-72" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb16-73"><a href="#cb16-73" tabindex="-1"></a><span class="co">#&gt; glm(formula = glm_formula)</span></span>
<span id="cb16-74"><a href="#cb16-74" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-75"><a href="#cb16-75" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb16-76"><a href="#cb16-76" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb16-77"><a href="#cb16-77" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.36962    0.08331   4.437 1.12e-05 ***</span></span>
<span id="cb16-78"><a href="#cb16-78" tabindex="-1"></a><span class="co">#&gt; TREATMENT   -0.16672    0.09601  -1.737   0.0831 .  </span></span>
<span id="cb16-79"><a href="#cb16-79" tabindex="-1"></a><span class="co">#&gt; S           -0.02827    0.09593  -0.295   0.7684    </span></span>
<span id="cb16-80"><a href="#cb16-80" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb16-81"><a href="#cb16-81" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb16-82"><a href="#cb16-82" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-83"><a href="#cb16-83" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for gaussian family taken to be 1.149205)</span></span>
<span id="cb16-84"><a href="#cb16-84" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-85"><a href="#cb16-85" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 574.74  on 499  degrees of freedom</span></span>
<span id="cb16-86"><a href="#cb16-86" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 571.16  on 497  degrees of freedom</span></span>
<span id="cb16-87"><a href="#cb16-87" tabindex="-1"></a><span class="co">#&gt; AIC: 1493.5</span></span>
<span id="cb16-88"><a href="#cb16-88" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-89"><a href="#cb16-89" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 2</span></span>
<span id="cb16-90"><a href="#cb16-90" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-91"><a href="#cb16-91" tabindex="-1"></a><span class="co">#&gt; =======================================================</span></span>
<span id="cb16-92"><a href="#cb16-92" tabindex="-1"></a><span class="fu">plot</span>(model_with_tve_covariate, <span class="at">what_plot=</span><span class="st">&quot;tvem&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Notice that we now get a time-varying effects plot which includes a
coefficient for the effect of <span class="math inline">\(S\)</span>, in
addition to the coefficients for the effect of <span class="math inline">\(X\)</span>. In this example <span class="math inline">\(\alpha_S(t)\)</span> is not significantly nonzero
at any time and does not change over time, so there is no evidence that
covariate <span class="math inline">\(S\)</span> is important in
predicting the outcome <span class="math inline">\(Y\)</span>. As
before, the <span class="math inline">\(X=1\)</span> group has lower
values on the mediator than the <span class="math inline">\(X=0\)</span>
group (i.e., their contrast is negative) at least at later time
points.</p>
<p>Alternatively, by specifying <code>tie_covariates_on_mediator</code>
instead of <code>tve_covariates_on_mediator,</code> the covariate can be
assumed to have a time-invariant effect rather than a time-varying
effect on <span class="math inline">\(M\)</span>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>model_with_tie_covariate <span class="ot">&lt;-</span> <span class="fu">funmediation</span>(<span class="at">data=</span>data_with_covariate,</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>                                          <span class="at">treatment=</span>X,</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>                                          <span class="at">mediator=</span>M,</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>                                          <span class="at">outcome=</span>Y,</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>                                          <span class="at">tie_covariates_on_mediator =</span> <span class="sc">~</span>S,</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>                                          <span class="at">covariates_on_outcome =</span> <span class="sc">~</span>S,  </span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>                                          <span class="at">id=</span>subject_id,</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>                                          <span class="at">time=</span>t,</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>                                          <span class="at">nboot=</span><span class="dv">10</span>)</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co">#&gt; Warning in funmediation(data = data_with_covariate, treatment = X, mediator =</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#&gt; M, : The number of bootstrap samples was very small and results will be</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co">#&gt; dubious.</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, (1 + c(conf, -conf))/2): extreme order statistics used</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co">#&gt; as endpoints</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, alpha): extreme order statistics used as endpoints</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, (1 + c(conf, -conf))/2): extreme order statistics used</span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="co">#&gt; as endpoints</span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, alpha): extreme order statistics used as endpoints</span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="fu">print</span>(model_with_tie_covariate)</span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a><span class="co">#&gt; Functional Regression Mediation Function Output </span></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a><span class="co">#&gt; TREATMENT: X </span></span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a><span class="co">#&gt; MEDIATOR: M (Assumed Continuous) </span></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a><span class="co">#&gt; OUTCOME: Y (Assumed Continuous) </span></span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a><span class="co">#&gt; DIRECT EFFECT OF X ...</span></span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a><span class="co">#&gt;  Direct effect estimate:</span></span>
<span id="cb17-29"><a href="#cb17-29" tabindex="-1"></a><span class="co">#&gt; 0.1125763</span></span>
<span id="cb17-30"><a href="#cb17-30" tabindex="-1"></a><span class="co">#&gt;  Direct effect standard error:</span></span>
<span id="cb17-31"><a href="#cb17-31" tabindex="-1"></a><span class="co">#&gt; 0.1009101</span></span>
<span id="cb17-32"><a href="#cb17-32" tabindex="-1"></a><span class="co">#&gt;  Direct effect bootstrap estimate:</span></span>
<span id="cb17-33"><a href="#cb17-33" tabindex="-1"></a><span class="co">#&gt; 0.11074</span></span>
<span id="cb17-34"><a href="#cb17-34" tabindex="-1"></a><span class="co">#&gt;  Direct effect bootstrap confidence interval: </span></span>
<span id="cb17-35"><a href="#cb17-35" tabindex="-1"></a><span class="co">#&gt;   ... by normal method:</span></span>
<span id="cb17-36"><a href="#cb17-36" tabindex="-1"></a><span class="co">#&gt;  -0.0443 ,  0.2658</span></span>
<span id="cb17-37"><a href="#cb17-37" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb17-38"><a href="#cb17-38" tabindex="-1"></a><span class="co">#&gt; INDIRECT EFFECT OF X ...</span></span>
<span id="cb17-39"><a href="#cb17-39" tabindex="-1"></a><span class="co">#&gt;  Indirect effect parametric estimate:</span></span>
<span id="cb17-40"><a href="#cb17-40" tabindex="-1"></a><span class="co">#&gt;  -0.302025</span></span>
<span id="cb17-41"><a href="#cb17-41" tabindex="-1"></a><span class="co">#&gt;  Indirect effect bootstrap estimate:</span></span>
<span id="cb17-42"><a href="#cb17-42" tabindex="-1"></a><span class="co">#&gt;  -0.2680548</span></span>
<span id="cb17-43"><a href="#cb17-43" tabindex="-1"></a><span class="co">#&gt;  Indirect effect bootstrap confidence interval: </span></span>
<span id="cb17-44"><a href="#cb17-44" tabindex="-1"></a><span class="co">#&gt;   ... by normal method:</span></span>
<span id="cb17-45"><a href="#cb17-45" tabindex="-1"></a><span class="co">#&gt;  -0.3417 ,  -0.1944</span></span>
<span id="cb17-46"><a href="#cb17-46" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb17-47"><a href="#cb17-47" tabindex="-1"></a><span class="co">#&gt; Computation time:</span></span>
<span id="cb17-48"><a href="#cb17-48" tabindex="-1"></a><span class="co">#&gt; Time difference of 21.21128 secs</span></span>
<span id="cb17-49"><a href="#cb17-49" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb17-50"><a href="#cb17-50" tabindex="-1"></a><span class="co">#&gt; Time-varying Effects Model Predicting MEDIATOR from TREATMENT:</span></span>
<span id="cb17-51"><a href="#cb17-51" tabindex="-1"></a><span class="co">#&gt; Response variable:   MEDIATOR </span></span>
<span id="cb17-52"><a href="#cb17-52" tabindex="-1"></a><span class="co">#&gt; Response outcome distribution type: gaussian </span></span>
<span id="cb17-53"><a href="#cb17-53" tabindex="-1"></a><span class="co">#&gt; Time interval:   0.01 to 1 </span></span>
<span id="cb17-54"><a href="#cb17-54" tabindex="-1"></a><span class="co">#&gt; Number of subjects:  500</span></span>
<span id="cb17-55"><a href="#cb17-55" tabindex="-1"></a><span class="co">#&gt; Effects specified as time-varying:  (Intercept), TREATMENT</span></span>
<span id="cb17-56"><a href="#cb17-56" tabindex="-1"></a><span class="co">#&gt; You can use the plot function to view the plots.</span></span>
<span id="cb17-57"><a href="#cb17-57" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-58"><a href="#cb17-58" tabindex="-1"></a><span class="co">#&gt; Effects specified as non-time-varying: </span></span>
<span id="cb17-59"><a href="#cb17-59" tabindex="-1"></a><span class="co">#&gt;      estimate standard_error</span></span>
<span id="cb17-60"><a href="#cb17-60" tabindex="-1"></a><span class="co">#&gt; S -0.03008131     0.05790221</span></span>
<span id="cb17-61"><a href="#cb17-61" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-62"><a href="#cb17-62" tabindex="-1"></a><span class="co">#&gt; Back-end model fitted in mgcv::bam function: </span></span>
<span id="cb17-63"><a href="#cb17-63" tabindex="-1"></a><span class="co">#&gt; Method fREML</span></span>
<span id="cb17-64"><a href="#cb17-64" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb17-65"><a href="#cb17-65" tabindex="-1"></a><span class="co">#&gt; MEDIATOR ~ TREATMENT + S + s(time, bs = &quot;ps&quot;, by = NA, pc = 0, </span></span>
<span id="cb17-66"><a href="#cb17-66" tabindex="-1"></a><span class="co">#&gt;     k = 7, fx = FALSE) + s(time, bs = &quot;ps&quot;, by = TREATMENT, pc = 0, </span></span>
<span id="cb17-67"><a href="#cb17-67" tabindex="-1"></a><span class="co">#&gt;     m = c(2, 1), k = 7, fx = FALSE)</span></span>
<span id="cb17-68"><a href="#cb17-68" tabindex="-1"></a><span class="co">#&gt; Pseudolikelihood AIC: 83993.2</span></span>
<span id="cb17-69"><a href="#cb17-69" tabindex="-1"></a><span class="co">#&gt; Pseudolikelihood BIC: 84042.46 </span></span>
<span id="cb17-70"><a href="#cb17-70" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-71"><a href="#cb17-71" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb17-72"><a href="#cb17-72" tabindex="-1"></a><span class="co">#&gt; Functional Regression Model Predicting OUTCOME from MEDIATOR </span></span>
<span id="cb17-73"><a href="#cb17-73" tabindex="-1"></a><span class="co">#&gt;   and TREATMENT: </span></span>
<span id="cb17-74"><a href="#cb17-74" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-75"><a href="#cb17-75" tabindex="-1"></a><span class="co">#&gt; Family: gaussian </span></span>
<span id="cb17-76"><a href="#cb17-76" tabindex="-1"></a><span class="co">#&gt; Link function: identity </span></span>
<span id="cb17-77"><a href="#cb17-77" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-78"><a href="#cb17-78" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb17-79"><a href="#cb17-79" tabindex="-1"></a><span class="co">#&gt; OUTCOME ~ s(x = MEDIATOR.tmat, by = L.MEDIATOR) + TREATMENT + </span></span>
<span id="cb17-80"><a href="#cb17-80" tabindex="-1"></a><span class="co">#&gt;     S</span></span>
<span id="cb17-81"><a href="#cb17-81" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-82"><a href="#cb17-82" tabindex="-1"></a><span class="co">#&gt; Estimated degrees of freedom:</span></span>
<span id="cb17-83"><a href="#cb17-83" tabindex="-1"></a><span class="co">#&gt; 2  total = 5 </span></span>
<span id="cb17-84"><a href="#cb17-84" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-85"><a href="#cb17-85" tabindex="-1"></a><span class="co">#&gt; REML score: 729.0772     </span></span>
<span id="cb17-86"><a href="#cb17-86" tabindex="-1"></a><span class="co">#&gt; Scalar terms in functional regression model:</span></span>
<span id="cb17-87"><a href="#cb17-87" tabindex="-1"></a><span class="co">#&gt;  (Intercept)    TREATMENT            S </span></span>
<span id="cb17-88"><a href="#cb17-88" tabindex="-1"></a><span class="co">#&gt; -0.025787118  0.112576286 -0.001643264 </span></span>
<span id="cb17-89"><a href="#cb17-89" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb17-90"><a href="#cb17-90" tabindex="-1"></a><span class="co">#&gt; Parametric model for Predicting OUTCOME from TREATMENT </span></span>
<span id="cb17-91"><a href="#cb17-91" tabindex="-1"></a><span class="co">#&gt;   ignoring MEDIATOR: </span></span>
<span id="cb17-92"><a href="#cb17-92" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-93"><a href="#cb17-93" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb17-94"><a href="#cb17-94" tabindex="-1"></a><span class="co">#&gt; glm(formula = glm_formula)</span></span>
<span id="cb17-95"><a href="#cb17-95" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-96"><a href="#cb17-96" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb17-97"><a href="#cb17-97" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb17-98"><a href="#cb17-98" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.36962    0.08331   4.437 1.12e-05 ***</span></span>
<span id="cb17-99"><a href="#cb17-99" tabindex="-1"></a><span class="co">#&gt; TREATMENT   -0.16672    0.09601  -1.737   0.0831 .  </span></span>
<span id="cb17-100"><a href="#cb17-100" tabindex="-1"></a><span class="co">#&gt; S           -0.02827    0.09593  -0.295   0.7684    </span></span>
<span id="cb17-101"><a href="#cb17-101" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb17-102"><a href="#cb17-102" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb17-103"><a href="#cb17-103" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-104"><a href="#cb17-104" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for gaussian family taken to be 1.149205)</span></span>
<span id="cb17-105"><a href="#cb17-105" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-106"><a href="#cb17-106" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 574.74  on 499  degrees of freedom</span></span>
<span id="cb17-107"><a href="#cb17-107" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 571.16  on 497  degrees of freedom</span></span>
<span id="cb17-108"><a href="#cb17-108" tabindex="-1"></a><span class="co">#&gt; AIC: 1493.5</span></span>
<span id="cb17-109"><a href="#cb17-109" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-110"><a href="#cb17-110" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 2</span></span>
<span id="cb17-111"><a href="#cb17-111" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-112"><a href="#cb17-112" tabindex="-1"></a><span class="co">#&gt; =======================================================</span></span>
<span id="cb17-113"><a href="#cb17-113" tabindex="-1"></a><span class="fu">plot</span>(model_with_tie_covariate, <span class="at">what_plot=</span><span class="st">&quot;pfr&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The functional effect plot here is very similar to what it was
before. Now there are scalar estimates for <span class="math inline">\(\alpha_S=-0.03008\)</span> and <span class="math inline">\(\beta_S=-0.00164\)</span> but no plot for <span class="math inline">\(\alpha_S(t)\)</span> because <span class="math inline">\(\alpha_S\)</span> is now assumed not to vary over
time. Again, <span class="math inline">\(S\)</span> is not statistically
significant either as a predictor of the mediator or of the outcome,
because the coefficients are not large relative to their standard
errors.</p>
</div>
<div id="using-a-binary-mediator" class="section level2">
<h2>Using a Binary Mediator</h2>
<p>The mediator may be binary rather than continuous, in which case the
the TVEM uses the logistic link function. For purposes of this vignette
demonstration, we dichotomize <span class="math inline">\(M\)</span> in
the simulated dataset and use that as our binary mediator (this usually
would not be advisable for real data because it involves loss of
information).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>data_with_covariate<span class="sc">$</span>binary_M <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">*</span>(data_with_covariate<span class="sc">$</span>M <span class="sc">&gt;</span> <span class="fu">mean</span>(data_with_covariate<span class="sc">$</span>M))</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">head</span>(data_with_covariate)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt;   subject_id    t X          M        Y S binary_M</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt; 1          1 0.01 1 -2.9541303 -0.44206 0        0</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt; 2          1 0.05 1 -0.5834873 -0.44206 0        0</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt; 3          1 0.06 1  0.6919501 -0.44206 0        1</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt; 4          1 0.08 1  0.4411048 -0.44206 0        1</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt; 5          1 0.15 1 -1.2007641 -0.44206 0        0</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">#&gt; 6          1 0.17 1 -1.0369571 -0.44206 0        0</span></span></code></pre></div>
<p>Now we call the <code>funmediation</code> function and include the
<code>binary_mediator=TRUE</code> argument.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>model_with_binary_M <span class="ot">&lt;-</span> <span class="fu">funmediation</span>(<span class="at">data=</span>data_with_covariate,</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>                             <span class="at">treatment=</span>X,</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>                             <span class="at">mediator=</span>binary_M,</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>                             <span class="at">outcome=</span>Y,</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>                             <span class="at">id=</span>subject_id,</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>                             <span class="at">time=</span>t,</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>                             <span class="at">binary_mediator=</span><span class="cn">TRUE</span>,</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>                             <span class="at">nboot=</span><span class="dv">10</span>)</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="co">#&gt; Warning in funmediation(data = data_with_covariate, treatment = X, mediator =</span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="co">#&gt; binary_M, : The number of bootstrap samples was very small and results will be</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="co">#&gt; dubious.</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, (1 + c(conf, -conf))/2): extreme order statistics used</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="co">#&gt; as endpoints</span></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, alpha): extreme order statistics used as endpoints</span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, (1 + c(conf, -conf))/2): extreme order statistics used</span></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="co">#&gt; as endpoints</span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, alpha): extreme order statistics used as endpoints</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">print</span>(model_with_binary_M)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co">#&gt; Functional Regression Mediation Function Output </span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="co">#&gt; TREATMENT: X </span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="co">#&gt; MEDIATOR: binary_M (Assumed Binary) </span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="co">#&gt; OUTCOME: Y (Assumed Continuous) </span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="co">#&gt; DIRECT EFFECT OF X ...</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a><span class="co">#&gt;  Direct effect estimate:</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a><span class="co">#&gt; 0.03910025</span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="co">#&gt;  Direct effect standard error:</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="co">#&gt; 0.1004427</span></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a><span class="co">#&gt;  Direct effect bootstrap estimate:</span></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a><span class="co">#&gt; 0.07949018</span></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a><span class="co">#&gt;  Direct effect bootstrap confidence interval: </span></span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a><span class="co">#&gt;   ... by normal method:</span></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a><span class="co">#&gt;  -0.1906 ,  0.3497</span></span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a><span class="co">#&gt; INDIRECT EFFECT OF X ...</span></span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a><span class="co">#&gt;  Indirect effect parametric estimate:</span></span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a><span class="co">#&gt;  -0.8550336</span></span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a><span class="co">#&gt;  Indirect effect bootstrap estimate:</span></span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a><span class="co">#&gt;  -0.2207669</span></span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a><span class="co">#&gt;  Indirect effect bootstrap confidence interval: </span></span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a><span class="co">#&gt;   ... by normal method:</span></span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a><span class="co">#&gt;  -0.3184 ,  -0.1231</span></span>
<span id="cb20-28"><a href="#cb20-28" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb20-29"><a href="#cb20-29" tabindex="-1"></a><span class="co">#&gt; Computation time:</span></span>
<span id="cb20-30"><a href="#cb20-30" tabindex="-1"></a><span class="co">#&gt; Time difference of 30.91431 secs</span></span>
<span id="cb20-31"><a href="#cb20-31" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb20-32"><a href="#cb20-32" tabindex="-1"></a><span class="co">#&gt; Time-varying Effects Model Predicting MEDIATOR from TREATMENT:</span></span>
<span id="cb20-33"><a href="#cb20-33" tabindex="-1"></a><span class="co">#&gt; Response variable:   MEDIATOR </span></span>
<span id="cb20-34"><a href="#cb20-34" tabindex="-1"></a><span class="co">#&gt; Response outcome distribution type: binomial </span></span>
<span id="cb20-35"><a href="#cb20-35" tabindex="-1"></a><span class="co">#&gt; Time interval:   0.01 to 1 </span></span>
<span id="cb20-36"><a href="#cb20-36" tabindex="-1"></a><span class="co">#&gt; Number of subjects:  500</span></span>
<span id="cb20-37"><a href="#cb20-37" tabindex="-1"></a><span class="co">#&gt; Effects specified as time-varying:  (Intercept), TREATMENT</span></span>
<span id="cb20-38"><a href="#cb20-38" tabindex="-1"></a><span class="co">#&gt; You can use the plot function to view the plots.</span></span>
<span id="cb20-39"><a href="#cb20-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-40"><a href="#cb20-40" tabindex="-1"></a><span class="co">#&gt; Back-end model fitted in mgcv::bam function: </span></span>
<span id="cb20-41"><a href="#cb20-41" tabindex="-1"></a><span class="co">#&gt; Method fREML</span></span>
<span id="cb20-42"><a href="#cb20-42" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb20-43"><a href="#cb20-43" tabindex="-1"></a><span class="co">#&gt; MEDIATOR ~ TREATMENT + s(time, bs = &quot;ps&quot;, by = NA, pc = 0, k = 7, </span></span>
<span id="cb20-44"><a href="#cb20-44" tabindex="-1"></a><span class="co">#&gt;     fx = FALSE) + s(time, bs = &quot;ps&quot;, by = TREATMENT, pc = 0, </span></span>
<span id="cb20-45"><a href="#cb20-45" tabindex="-1"></a><span class="co">#&gt;     m = c(2, 1), k = 7, fx = FALSE)</span></span>
<span id="cb20-46"><a href="#cb20-46" tabindex="-1"></a><span class="co">#&gt; Pseudolikelihood AIC: 27100.7</span></span>
<span id="cb20-47"><a href="#cb20-47" tabindex="-1"></a><span class="co">#&gt; Pseudolikelihood BIC: 27134.79 </span></span>
<span id="cb20-48"><a href="#cb20-48" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-49"><a href="#cb20-49" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb20-50"><a href="#cb20-50" tabindex="-1"></a><span class="co">#&gt; Functional Regression Model Predicting OUTCOME from MEDIATOR </span></span>
<span id="cb20-51"><a href="#cb20-51" tabindex="-1"></a><span class="co">#&gt;   and TREATMENT: </span></span>
<span id="cb20-52"><a href="#cb20-52" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-53"><a href="#cb20-53" tabindex="-1"></a><span class="co">#&gt; Family: gaussian </span></span>
<span id="cb20-54"><a href="#cb20-54" tabindex="-1"></a><span class="co">#&gt; Link function: identity </span></span>
<span id="cb20-55"><a href="#cb20-55" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-56"><a href="#cb20-56" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb20-57"><a href="#cb20-57" tabindex="-1"></a><span class="co">#&gt; OUTCOME ~ s(x = MEDIATOR.tmat, by = L.MEDIATOR) + TREATMENT</span></span>
<span id="cb20-58"><a href="#cb20-58" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-59"><a href="#cb20-59" tabindex="-1"></a><span class="co">#&gt; Estimated degrees of freedom:</span></span>
<span id="cb20-60"><a href="#cb20-60" tabindex="-1"></a><span class="co">#&gt; 2  total = 4 </span></span>
<span id="cb20-61"><a href="#cb20-61" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-62"><a href="#cb20-62" tabindex="-1"></a><span class="co">#&gt; REML score: 731.6047     </span></span>
<span id="cb20-63"><a href="#cb20-63" tabindex="-1"></a><span class="co">#&gt; Scalar terms in functional regression model:</span></span>
<span id="cb20-64"><a href="#cb20-64" tabindex="-1"></a><span class="co">#&gt; (Intercept)   TREATMENT </span></span>
<span id="cb20-65"><a href="#cb20-65" tabindex="-1"></a><span class="co">#&gt; -0.62912300  0.03910025 </span></span>
<span id="cb20-66"><a href="#cb20-66" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb20-67"><a href="#cb20-67" tabindex="-1"></a><span class="co">#&gt; Parametric model for Predicting OUTCOME from TREATMENT </span></span>
<span id="cb20-68"><a href="#cb20-68" tabindex="-1"></a><span class="co">#&gt;   ignoring MEDIATOR: </span></span>
<span id="cb20-69"><a href="#cb20-69" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-70"><a href="#cb20-70" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb20-71"><a href="#cb20-71" tabindex="-1"></a><span class="co">#&gt; glm(formula = glm_formula)</span></span>
<span id="cb20-72"><a href="#cb20-72" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-73"><a href="#cb20-73" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb20-74"><a href="#cb20-74" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb20-75"><a href="#cb20-75" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.35608    0.06942   5.129 4.18e-07 ***</span></span>
<span id="cb20-76"><a href="#cb20-76" tabindex="-1"></a><span class="co">#&gt; TREATMENT   -0.16720    0.09591  -1.743   0.0819 .  </span></span>
<span id="cb20-77"><a href="#cb20-77" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb20-78"><a href="#cb20-78" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb20-79"><a href="#cb20-79" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-80"><a href="#cb20-80" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for gaussian family taken to be 1.147098)</span></span>
<span id="cb20-81"><a href="#cb20-81" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-82"><a href="#cb20-82" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 574.74  on 499  degrees of freedom</span></span>
<span id="cb20-83"><a href="#cb20-83" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 571.25  on 498  degrees of freedom</span></span>
<span id="cb20-84"><a href="#cb20-84" tabindex="-1"></a><span class="co">#&gt; AIC: 1491.6</span></span>
<span id="cb20-85"><a href="#cb20-85" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-86"><a href="#cb20-86" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 2</span></span>
<span id="cb20-87"><a href="#cb20-87" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-88"><a href="#cb20-88" tabindex="-1"></a><span class="co">#&gt; =======================================================</span></span>
<span id="cb20-89"><a href="#cb20-89" tabindex="-1"></a><span class="fu">plot</span>(model_with_binary_M, <span class="at">what_plot=</span><span class="st">&quot;coef&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA1VBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZrYgAAA6AAA6ADo6AGY6OgA6OmY6OpA6ZmY6ZpA6ZrY6kJA6kLY6kNtmAABmADpmAGZmOgBmOpBmZjpmZmZmkLZmkNtmtttmtv+QOgCQOmaQZgCQZjqQkDqQkGaQtpCQttuQ27aQ29uQ2/+2ZgC2Zjq2kDq2kGa2tpC225C227a22/+2/7a2/9u2///bkDrbkGbbtmbbtpDbtrbb25Db29vb2//b/9vb////tmb/25D/27b/29v//7b//9v/////RgaRAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQTklEQVR4nO2diXbjthWGIY8dVU2XLHLqpBPLSTpJa80Wt2YmTVJRE4vv/0gFQIAESID3YiFIavCfMyMSy8XFJ2yEKZJUWYMiUzswd2VAgDIgQBkQoAwIUAYEKAMClAEByoAAZUCAakC/v9w55WrSv78h5FNDgqdrQrb0syBkdd+JK8nF43Fz8WgwBxUXlMrPJw7odEecALXp96Qu1OTM1YHHw85AxePcA1P5+RQMyISndoYWxz6MzljMQcUFpfLziZBPDvSEZ/1pQ1ZfM0OrF5uLh+rdhkXSNE04eX5DVp836St+QAs70o52+UObkx99RUsoyUfXzBlhgR9cvpbf1uklUYvnVv5As8vUWvzbzer7G3L5QFNdPmpO3X6nWmFq/RGRApCfT2Qtzlh3YR2GIaZtseCntE1q4Ur6BlBZh9/KnLUzL2iWgnzGnJEWqtqmdGavmRNWrg5Nai3+7YafPWMf62rAKdYcVH/q9P4+7eknb09H9t2zRNTs+vAb/X9LT1f3avjVw+kVJaJ3MZ6ehsucwpl/Xl/9747+r1tYsy+ndubpmrUWWby08puSWo0/bmj8Ozol0G+O51edaiohulLrj4j094mU8kxwJzsaTEtqhqxOOPtfB1SnZOF1CuHMv5gnF/++bloY2dUp2wHx9OYronw/3EpbXjee9WX2X9k2N1lkqQLq+lO2gDx8agEVbZmsizbDViecpdUBlbK7besUwpn7gvydrOsDYaFOyYpl/3h3J+33U1tpy9PjdUCKUz1Aqj8dQB4+qYCumsHsXmlBSjjcglRA7Eva1s4IC7x+zbdVktXzX0sap7egJnU3ngOiiWpAmlPYFuThkwTE6kmHtXe857Is1PjnB7oO3CrhhHbQQqY3jkEqIBrO/mP9vbWwPryX/b2g09Hp29qZ1krrhx6vA1JNtoC2/TGoA8jdJw6oXju1EwOvZiEaW2/C2CprLb4OKuWgoQPiI9+TfcYoiVJCMyq0E5Qe/70GSHVKMmicUvzpAvLwqRTT/QWdoJp1EC+Hr4PooqYNZ6sKvnbg6RtA1c/tOkgBRIte1wfSQmfNwU5+vK7XUdSctNKk1uLf6IAUpySDxinFny4gD58qtNo56kNSBgQoAwKU94MAZUCAMiBAGRCgDAgQBIhEV6C/qf0JjXdWKKA4XuANZkCIeHaZ/p87uTM5pkMkBqDoLoHxe7Y1RBfJhYFQVG9IuEFuInQg6xoE4p++uOf/quPHj6b4uM5E6WIREWEB/e1xfEAkgsEmeyxGM+piJIZBNXsURDMapKMDioJoRtP8CIAiIDoXQPaF78gLKzVeHaQjXRn0S4pfnzCLs2lBpPMZaAYKCzIYM97ZjzF6RIhNFID6b0TGW30yIPpvL/4Kux9xHTQqoBCjyJU014graWI4sordnLN188ffzXkAIsZDm1hLZq3axR9vP1FdTHQt2dWiFGyzAhusv7Dy4nE2gOTf70cbpInl2CzRosurX1xatK+j00zz+iqTuAGSLbro3nkqs5uXr75L9JHjTVla/w2LcdQgLQiZAVmW+IkBBVxqDGeJMc2bXfNs7CPH9zMAOSKtg/zapoc/sQHZ04saORgEZrEeIi9CiQHZ1nFth425ku4gWgAg85WSPqU5GewZIf1QoHjI8MjxUOJetTAGXS6eQwlNC8hvKHW6eNZKmDmg3rzrt1xxvTZUC3EnlA5Ql4VlFRUfUOXfhhCTRkRA2ol1kYm/1MBfPPsSIoj04wAaWIJjDLpfPGuXN4gSWlvJLjU6KzjnAt2L0YK1gQjnNkH5E6sF6e4NtCaswWYkQvrTLxTClBSQxkePIXqrHwuQqWsNM5oEUO/yqLd+HhGQeZvIxgi5smfxHpvkllQ9b/qTyzhjkCjcNscNGMIA8tkkNyXqe2hoOOMBGpjABtarCEBem+SGNMNbWNhvDC7LPgAPDDmGkRHnD/HdJO8mAbf4kH0eVVhlgTG0/rJMpdguVg1skg8baPgMutSYitjFzPOWPaux1eAG6cFNcmt5bUtHXZUGAbLtBxnSDdno5xppmu8tyzAZUUt7N3/cCPVXsSMB6q51jG3dYiz2LNYf+dz+EuMCAHuHWY8PulgywjTfX1s4EYrfggzbwi5Wx1gH9QnhSxkBEOQLMAoABTr7YygyOiCHTXJw+MFdQ3trYCVItBNsOah1EH6TvNe9uufwuglK4J/dfUsI4Q9x2wM2tuRmQMf4NCIgfYWMRBQVkHkjLO60Gpbdd19xOB67SW5pPggvHBwKzd5pRMFdnsfjNsnNo6BrhRMCGvjbioyNOM1bri2c6zs2oP4yxHAFpwyaEQD1yiABfMYHZFo2moUyaIsfmJiUQI/ajg/IfDnSI4M06ByvFbAUQAGJXeP1vubiSUCearBFhxURFxAJ5pOiBTmVERNQ5wv0q2oKQC6FxAPkPLz5FRgnO76UiOsg91vFfAqMkz05oP7w6FvRswRkmD6864nIGON3/Gj/YgAyTK6ul6j4AqtIT4KIRRJ3qeFbukeB0R62EqkzelxqhI0jSEDhD1sZGdBAvH/3whRYRXvYivm7dZ2M2/jCsF1mvDTGOIcp0KpYD1uxDZ2uf3qWz4kmwM0L2EshsMBk2XvfriEC04KOG/5Gl+EWFIENyqGo2Tu7fKZjXBdj93UMA4rFx6WGMX6mTiwVcAREu9l6EFAsPIlbEM9hno1J5xMssCQDgOLxSbEfhLWI8gd5qRHBIWSBTAketlJhv3vUpUYMd7AFVmkettLYcgFkGxQTA0rxsJXWWIxrsUju4ApMCQhTO69rsUCfII3/sBUHgzw+zaCINzj2w1ZcDLL4wUExugLrk9ofAvT5qn9FE+90SJZf+yT3JwMCxLvYwKCY3CGpOQEaGhSTOwRrAkBzcmhu/jRJ5tKkYWVAgDIgQLMbgz5sZUCAMiBAGRCgDAhQBgQoAwKUAQHKgABlQIAGAPE3a/cODbGGrTYl9rghK9tVjJOm8WcA0H7dbqWtexvWWtC+624b+3S9Mz7zwl3T+GMHxK5exTehHBpiq6p81vnGlFj2Yb8QdtBE/tgBKZYMRtWg0zdvOw4psae7XVWa93LdNJE/MQAV226f19y9M9834qqJ/IkA6OnLw4BDT9fbOGPQRP5EALTf9WaN4bx+msif8EFa3AO6s+RNPkhH9ifONN9bd7Sxp7tIXWwifwYAsduVqaH9tjm0xBocUmKjLRSn8SdfagDKgABlQIAyIEAZEKAMCFAGBCgDApQBAcqAAGVAgDIgQBkQoAwIUP/SvyQXj8eNupvw+8td5abT6z8R8uxW3/p1NzMHIQCd7ohjzdiLOpi0zXF3M7OQGZAW4F6zgqxuq+rdRrs1fcmAftqQ1dfsjB5cvpYt6PSSNoJPDrw50NPjDSGXP7DNudWLzcUDz92GkdvvWGIeSs84Coa6Pi7rRykwMxRbnU7mPW5W39+Qywd6fhljZzayGKC9/CGC+EmCAFQHrwWgso67rTfF686jhxH5MAnZBinK+y6gQva9Ju9xww+ebYj5YRQTiwI6svbAkNDKrA/8z/z1GQ3+iZ7wvlHHvSIi1W8srxZ29XDaCzDyF+YsYwOoMbNlbea+zUsBrQ/vCPn0wF7scZwShkkUkPguya4emttB+vTmKyJrVoew6soOVPXCShhQM/q3eRkuzoynKifiYBUFVEhAdQWZ6+wfH4IaQHUcPdyyjlPnVcN0QIYupprR8uqAiok4WMUBiemYe9m0oJKsnv/KGkOvBUlAthbE+1FVvwsH3YLo6VwB0UHgtnonR5f3cgwq6KRy+rYGtNXGGwlIG4MUQHR4b6Z5mlnYlGY+P7y/4W2uGYNUQHMcgyyzWClPWHwzUu2qFlClhGmA1IXiXjdTyLMmrw5oOhIWMUCnV8Z1EDv5kdGgKxQ6of3croOatWUbpgESlxrPWc890fXRX16LhRQ1w9dBD0reuQOa2oG5KwMClAEByoAAZUCAMiBAGRCgDAgQBKj7MJlwJalWPIGAUhc4N2VAgNICIhkQaCwDspsikQ0mUUpAsQ0mUTJAvm+0m1qpAJHewUKUCFDQO9smVRpAxHi4CCUBRCzHS1AKQMR6sgDZ/I13bRnnrVuTafwWNMZz3hJqbED9160HGkytkQH1s2dAQO4MSMnbHX7YmJ8B2fLmLdduTn35k/ekhzLmTfvBfIv/qwa7R/WXTfgb4ZRc6tWpjmeJgPbbqmB0At8pqGQiymGn+SwQkPG1nQE9YgjP+QBS4j1MyiPD4LNAQM1jZaJ0MeWdecbBeYmA2CN1KstrNVzr026tWqauJQIKie+kNjcff4PTKyogS+/yNzgDRQTUDMOD68IPFpAZT94PksmQeD5QQATXu/AGZ6QIgPCtB2lwVgoGhJjZ3QzOTGGAiCue8wGEqCux4RlkcC6AoHhivWYfMrbM7Q7neB0DqvW0cWcOqMcAsfDp8PTzczLhARkJDOMx5vDzczJhANkax2DrsXW3EQHpG35PX9xbXhzrJAQgcKLr4xkYq1MCQqSqngCj3usgKx5oJgMKDJAXIOiH+p6ArL0L83LpsUSrfvz4H/wJACUhH/EudvzzDX/uQf3QDcIfEiF+1s5Dj5tAf83jiJUOXP2RAW22VcmI7KpixQFtdvxVGsXVgQVyhvLpBzx0hBZkaT0YOogCA8Rq/0f+dH/2ZpF6kBYB7Ey8bkQCEqHRAdk6F/YvaGN3sUf2UbSAWAB7dtPqvugAqkMRgOTjo4j6ZIiByTsETyJApQ6oRmJoQRVykO6+gqEb35wE40kESBmDaAAbbUQg7XGs0zGJUBQg8Ycxa7w4jIAnESDWfz5rWlAlZi4+i7VP46tD441BUfCc56VGFbLucS1wbsIBiobnPAHZ8PjwOUNA1t7leXOVT6YJBQKy0fGt6uiA9BdishlLfJhvgILkBEiPcC4LVWCw9BdiluxRjvyDnXs8I80BkFM+7wJDpbxrjS2d6XJQfFQF+euYLcgtm3+Boeq8gY41H/Hx396rDzFCAuoGOpeDLjBUHUDiCrX+iAnIPjaH8UkMSLysT3yM0oLcs4QVGKKCkLUGqKg3D8VHIkCBNUw4SHfaTyJAoRVMOM2LjQ25v5EEUPhvUUYH1L4Qs37O7k58VCkAxfiVeLCFtHICFKNy5wwoSt3OGFCcqp0toFg/FVwgIOOffZT4zkF4gYsS8s8+8X5qukhAhj/76NdhEWu1SEBQfMyfKp8joKh1Wiwgy/1GJHaVzhDQSAUuRBkQILc/+8RQkmrFE8Lf4f36kNMlKAMClAEByoAAZUCAMiBAGRCgDAjQAl1OqwwIUAYEKAMClAEByoAAZUCAMiBAGRCgDAjQACDllnXl0BBruDNJv919Zf6B9iI0AKi9l009NMTSky4+/Xb3YoZvAcfKDki5G1K9MbIfW1Xls04LUmI79y0vTnZASs0MlVSDTt+87QBSYtmPAErTQ1AXohiAim13DNLw3ZEF84kB6OnL3o8g1Njr7ZmOQWhA+11vFhvOuyiFD9LiBrWdJe/5AnKZ5nvroDaW3Zx1nl1MuWVdHlpiDYCU2PNdKGYxZUCAMiBA/weuIUhpF/zkygAAAABJRU5ErkJggg==" /><!-- --></p>
<p>The plots are similar to those shown in the previous example with
numerical mediator, except that the TVEM coefficient functions for the
intercept and treatment effects on the outcome are interpreted on the
logit scale as in logistic regression.</p>
<p>Note that if the <code>binary_mediator=TRUE</code> argument is not
specified, the TVEM will be fit using an identity link (hence a linear
model at any given time <span class="math inline">\(t\)</span>) as for a
normally distributed outcome. The function would not detect that
<code>binary_M</code> consists of zeroes and ones and no other numbers.
The identity link is probably not the best approach but might be
interesting as a comparison. If the mediator is binary, it is probably
better to use <code>binary_mediator=TRUE</code> in order to specify that
the <span class="math inline">\(\alpha\)</span> coefficients are to be
interpreted on the logit (logistic regression) scale. A future version
of this package might allow log link functions as an alternative to
logit link functions, but this is currently not available.</p>
</div>
</div>
<div id="example-with-a-binary-outcome" class="section level1">
<h1>Example with a Binary Outcome</h1>
<p>In addition to, or instead of, a binary mediator, the outcome may
also binary. In this case, the scalar-on-function part of the model (the
<span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_X\)</span> and <span class="math inline">\(\beta_M(t)\)</span> functions) are fit using a
logistic link function. To demonstrate this, we first simulate a dataset
with a binary outcome, using the <code>simulate_binary_Y</code> argument
in <code>simulate_funmediation_example</code> function. We set this
argument to TRUE, as it is FALSE by default. (Note that we do not
currently have a corresponding <code>simulate_binary_M</code> argument
in this function, as simulating realistic binary data trajectories is
somewhat more difficult.)</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>simulation_with_binary_Y <span class="ot">&lt;-</span> <span class="fu">simulate_funmediation_example</span>(<span class="at">simulate_binary_Y=</span><span class="cn">TRUE</span>, </span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>                                                          <span class="at">nsub=</span><span class="dv">500</span>)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>data_with_binary_Y <span class="ot">&lt;-</span> simulation_with_binary_Y<span class="sc">$</span>dataset</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="fu">head</span>(data_with_binary_Y)</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="co">#&gt;   subject_id    t X           M Y</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="co">#&gt; 1          1 0.01 1  0.58107828 0</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co">#&gt; 2          1 0.02 1  3.99963771 0</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="co">#&gt; 3          1 0.03 1  1.54573431 0</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="co">#&gt; 4          1 0.08 1  1.37180632 0</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="co">#&gt; 5          1 0.09 1 -0.05694934 0</span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="co">#&gt; 6          1 0.15 1 -2.15847027 0</span></span></code></pre></div>
<p>Now we fit the model, using the new dataset with binary <span class="math inline">\(Y\)</span>, and using the
<code>binary_outcome=TRUE</code> argument. By default,
<code>binary_outcome</code> is FALSE. The
<code>binary_outcome=TRUE</code> argument specifies that the <span class="math inline">\(\beta\)</span> coefficients are to be interpreted
as logistic regression coefficients, similar to the
<code>binary_mediator=TRUE</code> argument which does the same for the
<span class="math inline">\(\alpha\)</span> coefficients.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>model_with_binary_Y <span class="ot">&lt;-</span> <span class="fu">funmediation</span>(<span class="at">data=</span>data_with_binary_Y,</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>                                    <span class="at">treatment=</span>X,</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>                                    <span class="at">mediator=</span>M,</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>                                    <span class="at">outcome=</span>Y,</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>                                    <span class="at">id=</span>subject_id,</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>                                    <span class="at">time=</span>t,</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>                                    <span class="at">binary_outcome=</span><span class="cn">TRUE</span>,</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>                                    <span class="at">nboot=</span><span class="dv">10</span>)</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="co">#&gt; Warning in funmediation(data = data_with_binary_Y, treatment = X, mediator = M,</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="co">#&gt; : The number of bootstrap samples was very small and results will be dubious.</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, (1 + c(conf, -conf))/2): extreme order statistics used</span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="co">#&gt; as endpoints</span></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, alpha): extreme order statistics used as endpoints</span></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, (1 + c(conf, -conf))/2): extreme order statistics used</span></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a><span class="co">#&gt; as endpoints</span></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, alpha): extreme order statistics used as endpoints</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">print</span>(model_with_binary_Y)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="co">#&gt; Functional Regression Mediation Function Output </span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="co">#&gt; TREATMENT: X </span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="co">#&gt; MEDIATOR: M (Assumed Continuous) </span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="co">#&gt; OUTCOME: Y (Assumed Binary) </span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="co">#&gt; DIRECT EFFECT OF X ...</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="co">#&gt;  Direct effect estimate:</span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a><span class="co">#&gt; -0.02380259</span></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a><span class="co">#&gt;  Direct effect standard error:</span></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a><span class="co">#&gt; 0.2002658</span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a><span class="co">#&gt;  Direct effect bootstrap estimate:</span></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a><span class="co">#&gt; 0.04756748</span></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a><span class="co">#&gt;  Direct effect bootstrap confidence interval: </span></span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a><span class="co">#&gt;   ... by normal method:</span></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="co">#&gt;  -0.4885 ,  0.5837</span></span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a><span class="co">#&gt; INDIRECT EFFECT OF X ...</span></span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a><span class="co">#&gt;  Indirect effect parametric estimate:</span></span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a><span class="co">#&gt;  -0.1556537</span></span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a><span class="co">#&gt;  Indirect effect bootstrap estimate:</span></span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a><span class="co">#&gt;  -0.1477143</span></span>
<span id="cb23-25"><a href="#cb23-25" tabindex="-1"></a><span class="co">#&gt;  Indirect effect bootstrap confidence interval: </span></span>
<span id="cb23-26"><a href="#cb23-26" tabindex="-1"></a><span class="co">#&gt;   ... by normal method:</span></span>
<span id="cb23-27"><a href="#cb23-27" tabindex="-1"></a><span class="co">#&gt;  -0.2873 ,  -0.0081</span></span>
<span id="cb23-28"><a href="#cb23-28" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb23-29"><a href="#cb23-29" tabindex="-1"></a><span class="co">#&gt; Computation time:</span></span>
<span id="cb23-30"><a href="#cb23-30" tabindex="-1"></a><span class="co">#&gt; Time difference of 21.48093 secs</span></span>
<span id="cb23-31"><a href="#cb23-31" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb23-32"><a href="#cb23-32" tabindex="-1"></a><span class="co">#&gt; Time-varying Effects Model Predicting MEDIATOR from TREATMENT:</span></span>
<span id="cb23-33"><a href="#cb23-33" tabindex="-1"></a><span class="co">#&gt; Response variable:   MEDIATOR </span></span>
<span id="cb23-34"><a href="#cb23-34" tabindex="-1"></a><span class="co">#&gt; Response outcome distribution type: gaussian </span></span>
<span id="cb23-35"><a href="#cb23-35" tabindex="-1"></a><span class="co">#&gt; Time interval:   0.01 to 1 </span></span>
<span id="cb23-36"><a href="#cb23-36" tabindex="-1"></a><span class="co">#&gt; Number of subjects:  500</span></span>
<span id="cb23-37"><a href="#cb23-37" tabindex="-1"></a><span class="co">#&gt; Effects specified as time-varying:  (Intercept), TREATMENT</span></span>
<span id="cb23-38"><a href="#cb23-38" tabindex="-1"></a><span class="co">#&gt; You can use the plot function to view the plots.</span></span>
<span id="cb23-39"><a href="#cb23-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-40"><a href="#cb23-40" tabindex="-1"></a><span class="co">#&gt; Back-end model fitted in mgcv::bam function: </span></span>
<span id="cb23-41"><a href="#cb23-41" tabindex="-1"></a><span class="co">#&gt; Method fREML</span></span>
<span id="cb23-42"><a href="#cb23-42" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb23-43"><a href="#cb23-43" tabindex="-1"></a><span class="co">#&gt; MEDIATOR ~ TREATMENT + s(time, bs = &quot;ps&quot;, by = NA, pc = 0, k = 7, </span></span>
<span id="cb23-44"><a href="#cb23-44" tabindex="-1"></a><span class="co">#&gt;     fx = FALSE) + s(time, bs = &quot;ps&quot;, by = TREATMENT, pc = 0, </span></span>
<span id="cb23-45"><a href="#cb23-45" tabindex="-1"></a><span class="co">#&gt;     m = c(2, 1), k = 7, fx = FALSE)</span></span>
<span id="cb23-46"><a href="#cb23-46" tabindex="-1"></a><span class="co">#&gt; Pseudolikelihood AIC: 85466.42</span></span>
<span id="cb23-47"><a href="#cb23-47" tabindex="-1"></a><span class="co">#&gt; Pseudolikelihood BIC: 85505.49 </span></span>
<span id="cb23-48"><a href="#cb23-48" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-49"><a href="#cb23-49" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb23-50"><a href="#cb23-50" tabindex="-1"></a><span class="co">#&gt; Functional Regression Model Predicting OUTCOME from MEDIATOR </span></span>
<span id="cb23-51"><a href="#cb23-51" tabindex="-1"></a><span class="co">#&gt;   and TREATMENT: </span></span>
<span id="cb23-52"><a href="#cb23-52" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-53"><a href="#cb23-53" tabindex="-1"></a><span class="co">#&gt; Family: binomial </span></span>
<span id="cb23-54"><a href="#cb23-54" tabindex="-1"></a><span class="co">#&gt; Link function: logit </span></span>
<span id="cb23-55"><a href="#cb23-55" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-56"><a href="#cb23-56" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb23-57"><a href="#cb23-57" tabindex="-1"></a><span class="co">#&gt; OUTCOME ~ s(x = MEDIATOR.tmat, by = L.MEDIATOR) + TREATMENT</span></span>
<span id="cb23-58"><a href="#cb23-58" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-59"><a href="#cb23-59" tabindex="-1"></a><span class="co">#&gt; Estimated degrees of freedom:</span></span>
<span id="cb23-60"><a href="#cb23-60" tabindex="-1"></a><span class="co">#&gt; 2  total = 4 </span></span>
<span id="cb23-61"><a href="#cb23-61" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-62"><a href="#cb23-62" tabindex="-1"></a><span class="co">#&gt; REML score: 339.0038     </span></span>
<span id="cb23-63"><a href="#cb23-63" tabindex="-1"></a><span class="co">#&gt; Scalar terms in functional regression model:</span></span>
<span id="cb23-64"><a href="#cb23-64" tabindex="-1"></a><span class="co">#&gt; (Intercept)   TREATMENT </span></span>
<span id="cb23-65"><a href="#cb23-65" tabindex="-1"></a><span class="co">#&gt;  0.27297288 -0.02380259 </span></span>
<span id="cb23-66"><a href="#cb23-66" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb23-67"><a href="#cb23-67" tabindex="-1"></a><span class="co">#&gt; Parametric model for Predicting OUTCOME from TREATMENT </span></span>
<span id="cb23-68"><a href="#cb23-68" tabindex="-1"></a><span class="co">#&gt;   ignoring MEDIATOR: </span></span>
<span id="cb23-69"><a href="#cb23-69" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-70"><a href="#cb23-70" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb23-71"><a href="#cb23-71" tabindex="-1"></a><span class="co">#&gt; glm(formula = glm_formula, family = binomial)</span></span>
<span id="cb23-72"><a href="#cb23-72" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-73"><a href="#cb23-73" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb23-74"><a href="#cb23-74" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb23-75"><a href="#cb23-75" tabindex="-1"></a><span class="co">#&gt; (Intercept)   0.4855     0.1355   3.583 0.000339 ***</span></span>
<span id="cb23-76"><a href="#cb23-76" tabindex="-1"></a><span class="co">#&gt; TREATMENT    -0.1783     0.1832  -0.973 0.330608    </span></span>
<span id="cb23-77"><a href="#cb23-77" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb23-78"><a href="#cb23-78" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb23-79"><a href="#cb23-79" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-80"><a href="#cb23-80" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb23-81"><a href="#cb23-81" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-82"><a href="#cb23-82" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 674.60  on 499  degrees of freedom</span></span>
<span id="cb23-83"><a href="#cb23-83" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 673.65  on 498  degrees of freedom</span></span>
<span id="cb23-84"><a href="#cb23-84" tabindex="-1"></a><span class="co">#&gt; AIC: 677.65</span></span>
<span id="cb23-85"><a href="#cb23-85" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-86"><a href="#cb23-86" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span>
<span id="cb23-87"><a href="#cb23-87" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-88"><a href="#cb23-88" tabindex="-1"></a><span class="co">#&gt; =======================================================</span></span>
<span id="cb23-89"><a href="#cb23-89" tabindex="-1"></a><span class="fu">plot</span>(model_with_binary_Y, <span class="at">what_plot=</span><span class="st">&quot;coef&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Note that the relationship of the mediator function to the outcome is
now interpreted as a functional logistic regression coefficient rather
than a functional linear regression coefficient (see Dziak et al., 2019;
Goldsmith, Crainiceanu, Caffo &amp; Rice, 2011; Mousavi and Srensen,
2018 for descriptions of functional logistic regression).</p>
</div>
<div id="more-than-two-treatment-groups" class="section level1">
<h1>More than Two Treatment Groups</h1>
<p>In the preceding examples, the treatment was assumed to be
dichotomous and dummy-coded (0 for a control group and 1 for a treated
group).<br />
Thus, the coefficients were interpreted as effects of increasing the
binary variable <span class="math inline">\(X_i\)</span> from 0 to 1.
However, sometimes in practice there might be more than two groups in
the experiment; for example, there might be two different interventions
each being compared to the same control group. In this case, <span class="math inline">\(X_i\)</span> should not be coded as, say, 1, 2,
and 3, for the different groups, because in that case the
<code>funmediation</code> function would misinterpret the levels as if
they were actually numbers.<br />
To handle this, dummy-code multiple predictor variables so that, e.g.,
<code>X1</code> is 1 for treatment group 1 and 0 otherwise, and
<code>X2</code> is 1 for treatment group 2 and 0 otherwise. In this
case, the effect of <code>X1</code> represents the contrast between
group 1 and the remaining (reference) group 3, and the effect of
<code>X2</code> represents the contrast between group 2 and the
reference group. You could optionally choose a different reference group
(e.g., have a dummy code for group 2 and a dummy code for group 3,
leaving 1 as the reference level, instead of a dummy code for groups 1
and 2). Except when using data simulated by the package, you should code
the predictor variables yourself, keeping in mind which contrasts are
most interesting to you. Regardless, one of the treatment levels,
perhaps representing the control or reference group, does not get its
own predictor variable but is represented indirectly by having zeroes on
all the others.</p>
<p>The following code will simulate data from a study with three
treatment groups, hence two binary treatment variables.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>nboot <span class="ot">&lt;-</span> <span class="dv">99</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>answers <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {<span class="fu">return</span>(<span class="sc">-</span>(t<span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span>.<span class="dv">5</span>)}</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {<span class="fu">return</span>(<span class="fu">sqrt</span>(t))}</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="cf">function</span>(t) {<span class="fu">return</span>(<span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span><span class="fl">3.141593</span><span class="sc">*</span>t))}</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>the_simulation <span class="ot">&lt;-</span> <span class="fu">simulate_funmediation_example</span>(<span class="at">nlevels=</span><span class="dv">3</span>,</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>                          <span class="at">alpha_X =</span> <span class="fu">list</span>(f1,f2),</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>                          <span class="at">beta_M =</span> f3,</span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>                          <span class="at">beta_X =</span> <span class="fu">c</span>(.<span class="dv">2</span>,.<span class="dv">3</span>))</span></code></pre></div>
<p>In the code above, notice that <code>alpha_X</code>, the time-varying
effect of treatment on the mediator, has to be specified as a list of
two functions, corresponding to the two dummy-coded dimensions of
treatment. Similarly, <code>beta_X</code>, the direct effect of
treatment on outcome, is a vector of two numbers.</p>
<p>The first few lines of the resulting dataset look like this:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">head</span>(the_simulation<span class="sc">$</span>dataset)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="co">#&gt;   subject_id    t X1 X2           M        Y</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="co">#&gt; 1          1 0.01  1  0 -1.25501308 -2.56836</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="co">#&gt; 2          1 0.02  1  0 -0.12442401 -2.56836</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="co">#&gt; 3          1 0.03  1  0  0.02886934 -2.56836</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a><span class="co">#&gt; 4          1 0.06  1  0 -1.64544032 -2.56836</span></span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a><span class="co">#&gt; 5          1 0.09  1  0 -3.43521092 -2.56836</span></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a><span class="co">#&gt; 6          1 0.12  1  0 -0.24772361 -2.56836</span></span></code></pre></div>
<p>The following code will analyze this data:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>the_data <span class="ot">&lt;-</span> the_simulation<span class="sc">$</span>dataset</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>ans_funmed_3groups <span class="ot">&lt;-</span> <span class="fu">funmediation</span>(<span class="at">data=</span>the_data,</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>             <span class="at">treatment=</span><span class="sc">~</span>X1<span class="sc">+</span>X2,</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>             <span class="at">mediator=</span>M,</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>             <span class="at">outcome=</span>Y,</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>             <span class="at">tvem_num_knots=</span><span class="dv">5</span>,</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>             <span class="at">id=</span>subject_id,</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>             <span class="at">time=</span>t,</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>             <span class="at">nboot=</span><span class="dv">10</span>)</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a><span class="co">#&gt; Warning in funmediation(data = the_data, treatment = ~X1 + X2, mediator = M, :</span></span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a><span class="co">#&gt; The number of bootstrap samples was very small and results will be dubious.</span></span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, (1 + c(conf, -conf))/2): extreme order statistics used</span></span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a><span class="co">#&gt; as endpoints</span></span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, alpha): extreme order statistics used as endpoints</span></span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, (1 + c(conf, -conf))/2): extreme order statistics used</span></span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a><span class="co">#&gt; as endpoints</span></span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, alpha): extreme order statistics used as endpoints</span></span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, (1 + c(conf, -conf))/2): extreme order statistics used</span></span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a><span class="co">#&gt; as endpoints</span></span>
<span id="cb26-20"><a href="#cb26-20" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, alpha): extreme order statistics used as endpoints</span></span>
<span id="cb26-21"><a href="#cb26-21" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, (1 + c(conf, -conf))/2): extreme order statistics used</span></span>
<span id="cb26-22"><a href="#cb26-22" tabindex="-1"></a><span class="co">#&gt; as endpoints</span></span>
<span id="cb26-23"><a href="#cb26-23" tabindex="-1"></a><span class="co">#&gt; Warning in norm.inter(t, alpha): extreme order statistics used as endpoints</span></span></code></pre></div>
<p>The <code>print</code> function works as before to print the model
details.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">print</span>(ans_funmed_3groups)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a><span class="co">#&gt; Functional Regression Mediation Function Output </span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a><span class="co">#&gt; TREATMENT: X1 X2 </span></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a><span class="co">#&gt; MEDIATOR: M (Assumed Continuous) </span></span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a><span class="co">#&gt; OUTCOME: Y (Assumed Continuous) </span></span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a><span class="co">#&gt; DIRECT EFFECT OF X1 ...</span></span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a><span class="co">#&gt;  Direct effect estimate:</span></span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a><span class="co">#&gt; 0.0822701</span></span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a><span class="co">#&gt;  Direct effect standard error:</span></span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a><span class="co">#&gt; 0.1162471</span></span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a><span class="co">#&gt;  Direct effect bootstrap estimate:</span></span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a><span class="co">#&gt; 0.07430718</span></span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a><span class="co">#&gt;  Direct effect bootstrap confidence interval: </span></span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a><span class="co">#&gt;   ... by normal method:</span></span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a><span class="co">#&gt;  -0.0702 ,  0.2188 </span></span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a><span class="co">#&gt; DIRECT EFFECT OF X2 ...</span></span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a><span class="co">#&gt;  Direct effect estimate:</span></span>
<span id="cb27-21"><a href="#cb27-21" tabindex="-1"></a><span class="co">#&gt; 0.170827</span></span>
<span id="cb27-22"><a href="#cb27-22" tabindex="-1"></a><span class="co">#&gt;  Direct effect standard error:</span></span>
<span id="cb27-23"><a href="#cb27-23" tabindex="-1"></a><span class="co">#&gt; 0.1134873</span></span>
<span id="cb27-24"><a href="#cb27-24" tabindex="-1"></a><span class="co">#&gt;  Direct effect bootstrap estimate:</span></span>
<span id="cb27-25"><a href="#cb27-25" tabindex="-1"></a><span class="co">#&gt; 0.2420447</span></span>
<span id="cb27-26"><a href="#cb27-26" tabindex="-1"></a><span class="co">#&gt;  Direct effect bootstrap confidence interval: </span></span>
<span id="cb27-27"><a href="#cb27-27" tabindex="-1"></a><span class="co">#&gt;   ... by normal method:</span></span>
<span id="cb27-28"><a href="#cb27-28" tabindex="-1"></a><span class="co">#&gt;  0.0137 ,  0.4705</span></span>
<span id="cb27-29"><a href="#cb27-29" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb27-30"><a href="#cb27-30" tabindex="-1"></a><span class="co">#&gt; INDIRECT EFFECT OF X1 ...</span></span>
<span id="cb27-31"><a href="#cb27-31" tabindex="-1"></a><span class="co">#&gt;  Indirect effect parametric estimate:</span></span>
<span id="cb27-32"><a href="#cb27-32" tabindex="-1"></a><span class="co">#&gt;  0.05440521</span></span>
<span id="cb27-33"><a href="#cb27-33" tabindex="-1"></a><span class="co">#&gt;  Indirect effect bootstrap estimate:</span></span>
<span id="cb27-34"><a href="#cb27-34" tabindex="-1"></a><span class="co">#&gt;  0.1091657</span></span>
<span id="cb27-35"><a href="#cb27-35" tabindex="-1"></a><span class="co">#&gt;  Indirect effect bootstrap confidence interval: </span></span>
<span id="cb27-36"><a href="#cb27-36" tabindex="-1"></a><span class="co">#&gt;   ... by normal method:</span></span>
<span id="cb27-37"><a href="#cb27-37" tabindex="-1"></a><span class="co">#&gt;  -0.0879 ,  0.3063</span></span>
<span id="cb27-38"><a href="#cb27-38" tabindex="-1"></a><span class="co">#&gt; INDIRECT EFFECT OF X2 ...</span></span>
<span id="cb27-39"><a href="#cb27-39" tabindex="-1"></a><span class="co">#&gt;  Indirect effect parametric estimate:</span></span>
<span id="cb27-40"><a href="#cb27-40" tabindex="-1"></a><span class="co">#&gt;  -0.02585488</span></span>
<span id="cb27-41"><a href="#cb27-41" tabindex="-1"></a><span class="co">#&gt;  Indirect effect bootstrap estimate:</span></span>
<span id="cb27-42"><a href="#cb27-42" tabindex="-1"></a><span class="co">#&gt;  -0.08227223</span></span>
<span id="cb27-43"><a href="#cb27-43" tabindex="-1"></a><span class="co">#&gt;  Indirect effect bootstrap confidence interval: </span></span>
<span id="cb27-44"><a href="#cb27-44" tabindex="-1"></a><span class="co">#&gt;   ... by normal method:</span></span>
<span id="cb27-45"><a href="#cb27-45" tabindex="-1"></a><span class="co">#&gt;  -0.2954 ,  0.1309</span></span>
<span id="cb27-46"><a href="#cb27-46" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb27-47"><a href="#cb27-47" tabindex="-1"></a><span class="co">#&gt; Computation time:</span></span>
<span id="cb27-48"><a href="#cb27-48" tabindex="-1"></a><span class="co">#&gt; Time difference of 29.08924 secs</span></span>
<span id="cb27-49"><a href="#cb27-49" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb27-50"><a href="#cb27-50" tabindex="-1"></a><span class="co">#&gt; Time-varying Effects Model Predicting MEDIATOR from TREATMENT:</span></span>
<span id="cb27-51"><a href="#cb27-51" tabindex="-1"></a><span class="co">#&gt; Response variable:   MEDIATOR </span></span>
<span id="cb27-52"><a href="#cb27-52" tabindex="-1"></a><span class="co">#&gt; Response outcome distribution type: gaussian </span></span>
<span id="cb27-53"><a href="#cb27-53" tabindex="-1"></a><span class="co">#&gt; Time interval:   0.01 to 1 </span></span>
<span id="cb27-54"><a href="#cb27-54" tabindex="-1"></a><span class="co">#&gt; Number of subjects:  500</span></span>
<span id="cb27-55"><a href="#cb27-55" tabindex="-1"></a><span class="co">#&gt; Effects specified as time-varying:  (Intercept), TREATMENT1, TREATMENT2</span></span>
<span id="cb27-56"><a href="#cb27-56" tabindex="-1"></a><span class="co">#&gt; You can use the plot function to view the plots.</span></span>
<span id="cb27-57"><a href="#cb27-57" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-58"><a href="#cb27-58" tabindex="-1"></a><span class="co">#&gt; Back-end model fitted in mgcv::bam function: </span></span>
<span id="cb27-59"><a href="#cb27-59" tabindex="-1"></a><span class="co">#&gt; Method fREML</span></span>
<span id="cb27-60"><a href="#cb27-60" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb27-61"><a href="#cb27-61" tabindex="-1"></a><span class="co">#&gt; MEDIATOR ~ TREATMENT1 + TREATMENT2 + s(time, bs = &quot;ps&quot;, by = NA, </span></span>
<span id="cb27-62"><a href="#cb27-62" tabindex="-1"></a><span class="co">#&gt;     pc = 0, k = 9, fx = FALSE) + s(time, bs = &quot;ps&quot;, by = TREATMENT1, </span></span>
<span id="cb27-63"><a href="#cb27-63" tabindex="-1"></a><span class="co">#&gt;     pc = 0, m = c(2, 1), k = 9, fx = FALSE) + s(time, bs = &quot;ps&quot;, </span></span>
<span id="cb27-64"><a href="#cb27-64" tabindex="-1"></a><span class="co">#&gt;     by = TREATMENT2, pc = 0, m = c(2, 1), k = 9, fx = FALSE)</span></span>
<span id="cb27-65"><a href="#cb27-65" tabindex="-1"></a><span class="co">#&gt; Pseudolikelihood AIC: 84878.53</span></span>
<span id="cb27-66"><a href="#cb27-66" tabindex="-1"></a><span class="co">#&gt; Pseudolikelihood BIC: 84943.49 </span></span>
<span id="cb27-67"><a href="#cb27-67" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-68"><a href="#cb27-68" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb27-69"><a href="#cb27-69" tabindex="-1"></a><span class="co">#&gt; Functional Regression Model Predicting OUTCOME from MEDIATOR </span></span>
<span id="cb27-70"><a href="#cb27-70" tabindex="-1"></a><span class="co">#&gt;   and TREATMENT: </span></span>
<span id="cb27-71"><a href="#cb27-71" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-72"><a href="#cb27-72" tabindex="-1"></a><span class="co">#&gt; Family: gaussian </span></span>
<span id="cb27-73"><a href="#cb27-73" tabindex="-1"></a><span class="co">#&gt; Link function: identity </span></span>
<span id="cb27-74"><a href="#cb27-74" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-75"><a href="#cb27-75" tabindex="-1"></a><span class="co">#&gt; Formula:</span></span>
<span id="cb27-76"><a href="#cb27-76" tabindex="-1"></a><span class="co">#&gt; OUTCOME ~ s(x = MEDIATOR.tmat, by = L.MEDIATOR) + TREATMENT1 + </span></span>
<span id="cb27-77"><a href="#cb27-77" tabindex="-1"></a><span class="co">#&gt;     TREATMENT2</span></span>
<span id="cb27-78"><a href="#cb27-78" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-79"><a href="#cb27-79" tabindex="-1"></a><span class="co">#&gt; Estimated degrees of freedom:</span></span>
<span id="cb27-80"><a href="#cb27-80" tabindex="-1"></a><span class="co">#&gt; 5.22  total = 8.22 </span></span>
<span id="cb27-81"><a href="#cb27-81" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-82"><a href="#cb27-82" tabindex="-1"></a><span class="co">#&gt; REML score: 706.8747     </span></span>
<span id="cb27-83"><a href="#cb27-83" tabindex="-1"></a><span class="co">#&gt; Scalar terms in functional regression model:</span></span>
<span id="cb27-84"><a href="#cb27-84" tabindex="-1"></a><span class="co">#&gt; (Intercept)  TREATMENT1  TREATMENT2 </span></span>
<span id="cb27-85"><a href="#cb27-85" tabindex="-1"></a><span class="co">#&gt; -0.03696895  0.08227010  0.17082700 </span></span>
<span id="cb27-86"><a href="#cb27-86" tabindex="-1"></a><span class="co">#&gt; ======================================================= </span></span>
<span id="cb27-87"><a href="#cb27-87" tabindex="-1"></a><span class="co">#&gt; Parametric model for Predicting OUTCOME from TREATMENT </span></span>
<span id="cb27-88"><a href="#cb27-88" tabindex="-1"></a><span class="co">#&gt;   ignoring MEDIATOR: </span></span>
<span id="cb27-89"><a href="#cb27-89" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-90"><a href="#cb27-90" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb27-91"><a href="#cb27-91" tabindex="-1"></a><span class="co">#&gt; glm(formula = glm_formula)</span></span>
<span id="cb27-92"><a href="#cb27-92" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-93"><a href="#cb27-93" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb27-94"><a href="#cb27-94" tabindex="-1"></a><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span id="cb27-95"><a href="#cb27-95" tabindex="-1"></a><span class="co">#&gt; (Intercept)  -0.1050     0.0798  -1.315    0.189</span></span>
<span id="cb27-96"><a href="#cb27-96" tabindex="-1"></a><span class="co">#&gt; TREATMENT1    0.1449     0.1146   1.265    0.207</span></span>
<span id="cb27-97"><a href="#cb27-97" tabindex="-1"></a><span class="co">#&gt; TREATMENT2    0.1070     0.1119   0.956    0.339</span></span>
<span id="cb27-98"><a href="#cb27-98" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-99"><a href="#cb27-99" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for gaussian family taken to be 1.069747)</span></span>
<span id="cb27-100"><a href="#cb27-100" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-101"><a href="#cb27-101" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 533.53  on 499  degrees of freedom</span></span>
<span id="cb27-102"><a href="#cb27-102" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 531.66  on 497  degrees of freedom</span></span>
<span id="cb27-103"><a href="#cb27-103" tabindex="-1"></a><span class="co">#&gt; AIC: 1457.6</span></span>
<span id="cb27-104"><a href="#cb27-104" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-105"><a href="#cb27-105" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 2</span></span>
<span id="cb27-106"><a href="#cb27-106" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-107"><a href="#cb27-107" tabindex="-1"></a><span class="co">#&gt; =======================================================</span></span></code></pre></div>
<p>The <code>pfr</code> plot is essentially the same as before, since
there is only one mediator.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">plot</span>(ans_funmed_3groups, <span class="at">use_panes=</span><span class="cn">TRUE</span>, <span class="at">what_plot =</span> <span class="st">&quot;pfr&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>In this example, the mediator seems to be positively related to the
outcome at earlier times, but weakly negatively related at later times,
although substantive interpretation of such functions requires care.</p>
<p>The <code>tvem</code> plot now shows the time-varying effects for
both predictors.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">plot</span>(ans_funmed_3groups, <span class="at">use_panes=</span><span class="cn">TRUE</span>, <span class="at">what_plot =</span> <span class="st">&quot;tvem&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The coefficient for the intercept shows that at least for the
reference group (group 3 in this example) the expected value of the
response tends to increase over time. The coefficient for the first
treatment variable (contrasting group 1 vs. group 3) shows a lower value
on the mediator for group 1 relative to group 3 (a negative contrast) at
least at the later time points. The coefficient for the second treatment
variable suggests that group 2 has a higher mean than group 3,
especially at later time points.</p>
<p>The <code>coefs</code> plot also includes the extra time-varying
effect. The indirect effects are not printed in the lower right pane
anymore, because that pane is needed for the new time-varying effect.
However, it can be viewed in the output from the <code>print</code>
statement as usual.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">plot</span>(ans_funmed_3groups, <span class="at">use_panes=</span><span class="cn">TRUE</span>, <span class="at">what_plot =</span> <span class="st">&quot;coefs&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Currently the package can still only handle a single mediator
variable. It doesn’t currently allow, for example, different mediator
variables for different treatment variables.</p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<ul>
<li><p>Dziak, J. J., Coffman, D. L., Reimherr, M., Petrovich, J., Li,
R., Shiffman, S., Shiyko, M. P. (2019). Scalar-on-function regression
for predicting distal outcomes from intensively gathered longitudinal
data: Interpretability for applied scientists. Statistical Surveys, 13:
150-180.</p></li>
<li><p>Goldsmith, J., Bobb, J., Crainiceanu, C., Caffo, B., and Reich,
D. (2011). Penalized functional regression. Journal of Computational and
Graphical Statistics, 20(4), 830-851.</p></li>
<li><p>Goldsmith, J., Crainiceanu, C. M., Caffo, B. S., &amp; Reich, D.
S. (2011). Penalized functional regression analysis of white-matter
tract profiles in multiple sclerosis. Neuroimage, 57(2):
431–439.</p></li>
<li><p>Hastie, T., &amp; Tibshirani, R. (1993). Varying-coefficient
models. Journal of the Royal Statistical Socety, B, 55:757-796.</p></li>
<li><p>Lindquist, M. A. (2012). Functional Causal Mediation Analysis
With an Application to Brain Connectivity. Journal of the American
Statistical Association, 107: 1297-1309.</p></li>
<li><p>Ramsay, J. O., &amp; Silverman, B. W. (2005). Functional data
analysis (2nd ed.). New York: Springer.</p></li>
<li><p>Mousavi, N., &amp; Srensen, H. (2018). Functional logistic
regression: a comparison of three methods. Journal of Statistical
Computation and Simulation, 88:2, 250-268.</p></li>
<li><p>Tan, X., Shiyko, M. P., Li, R., Li, Y., &amp; Deirker, L. (2012).
A time-varying effect model for intensive longitudinal data.
Psychological Methods, 17: 61-77.</p></li>
<li><p>Wood, S.N. (2017) Generalized Additive Models: an introduction
with R (2nd edition), CRC.</p></li>
</ul>
</div>
<div id="acknowledgements" class="section level1">
<h1>Acknowledgements</h1>
<p>The <code>pfr</code> function was developed by Jonathan Gellar,
Mathew W. McLean, Jeff Goldsmith, and Fabian Scheipl, the
<code>boot</code> package was written by Angelo Canty and Brian Ripley,
the <code>mgcv</code> package was developed by Simon N. Wood, and the
<code>refund</code> package was developed and maintained by Julia Wrobel
and others.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
